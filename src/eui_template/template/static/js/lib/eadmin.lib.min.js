/*!
 eadmin极速后台UI框架（我只想要个后台） | @author:317953536@qq.com 
*/
"use strict";var _createClass=function(){function n(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,a){return e&&n(t.prototype,e),a&&n(t,a),t}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Button=function(){function t(){_classCallCheck(this,t)}return _createClass(t,null,[{key:"run",value:function(t){var e=[t.find("button[data-delay]"),t.find("button[data-icon]:not([data-delay])")],t=e[0],e=e[1];t.each(function(){var t=$(this),e={html:t.html(),delay:t.data("delay")};t.attr("disabled",!0).html("倒计时（"+e.delay+"）秒后可操作"),e.time=setInterval(function(){e.delay--,t.html("倒计时（"+e.delay+"）秒后可操作"),0==e.delay&&(clearInterval(e.time),_.isUndefined(t.data("icon"))||(e.html='<i class="'+t.data("icon")+'"></i>'+e.html),t.attr("disabled",!1).html(e.html))},1e3)}),e.each(function(){var t=$(this),e="";t.is(":empty")&&(e+=' style="margin-right:0;"'),t.prepend("<i"+e+' class="'+t.data("icon")+'"></i>')})}},{key:"event",value:function(){var a=this;body.on("click","button[data-loading]",function(){var t=$(this),e=t.data("do");if(null==t.data("submit")&&(a.loading(t),null!=e))try{if(Method,!_.isFunction(Method[e]))return void console.log("指定的"+e+"不是一个可被调用的函数");Method[e](t)}catch(t){console.log(t)}})}},{key:"reset",value:function(t){t.attr("disabled",!1).html(t.data("source"))}},{key:"loading",value:function(t){t={this:t,icon:'<i class="ri-loader-4-line rotate"></i>'};t.this.attr("disabled",!0).data("source",t.this.html()).html(t.icon+t.this.data("loading"))}}]),t}(),_createClass=function(){function n(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,a){return e&&n(t.prototype,e),a&&n(t,a),t}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var EChart=function(){function l(t,e){_classCallCheck(this,l),this.dom=$(t),this.ctx=this.dom[0].getContext("2d");var a,n=["rgba(0, 132, 255","rgba(255, 24, 68","rgba(118, 255, 2","rgba(255, 255, 1","rgba(255, 142, 1","rgba(105, 240, 174","rgba(224, 64, 252","rgba(254, 87, 34"];for(a in this.gradient=[],this.color=[],n){var i=this.ctx.createLinearGradient(0,0,0,300);i.addColorStop(0,n[a]+", 0.5)"),i.addColorStop(1,n[a]+", 0)"),this.gradient.push(i),this.color.push(n[a]+")")}this.param=$.extend(!0,{type:"line",title:{show:!0,text:"默认图表"},legend:!0,responsive:!0},e),this.tooltips={backgroundColor:"rgba(0, 0, 0, 0.8)",intersect:!1,mode:"index",titleFontSize:14,bodySpacing:4,xPadding:10,yPadding:10,titleMarginBottom:8},this.layout={padding:{top:20}},this.hover={mode:"nearest",intersect:!0},this.skin={fontColor:"#36495C",lineColor:"#DCE8F2"},"dark"==Mount.skin&&(this.skin={fontColor:"#FFF",lineColor:"#151935"}),this.run()}return _createClass(l,[{key:"run",value:function(){switch(this.param.type){case"line":this._line();break;case"bar":this._bar();break;case"pie":this._pie()}}},{key:"_line",value:function(){var a=this,n={type:"line",data:{labels:this.param.labels,datasets:[]},options:{hover:this.hover,tooltips:this.tooltips,title:{display:this.param.title.show,fontSize:14,text:this.param.title.text,fontColor:this.skin.fontColor,padding:0},responsive:this.param.responsive,maintainAspectRatio:this.param.responsive,legend:{display:this.param.legend,labels:{fontColor:this.skin.fontColor}},layout:this.layout,scales:{xAxes:[{gridLines:{drawBorder:!0,color:this.skin.lineColor},ticks:{fontColor:this.skin.fontColor}}],yAxes:[{gridLines:{drawBorder:!0,color:this.skin.lineColor},ticks:{fontColor:this.skin.fontColor}}]}}};null!=this.param.labels&&0!=this.param.labels.length?null!=this.param.datas&&0!=this.param.datas.length?(this.param.title.show&&(this.layout.padding.top=0),_.each(this.param.datas,function(t,e){n.data.datasets.push({label:t.label,data:t.data,backgroundColor:a.gradient[e],borderColor:a.color[e],pointBackgroundColor:"#FFF",pointRadius:4,borderWidth:2,fill:!0})}),new Chart(this.ctx,n)):console.log("请指定图表具体数据"):console.log("请指定图表X轴")}},{key:"_bar",value:function(){var a=this,n={type:"bar",data:{labels:this.param.labels,datasets:[]},options:{hover:this.hover,tooltips:this.tooltips,title:{display:this.param.title.show,fontSize:14,text:this.param.title.text,fontColor:this.skin.fontColor,padding:0},responsive:this.param.responsive,maintainAspectRatio:this.param.responsive,legend:{display:this.param.legend,labels:{fontColor:this.skin.fontColor}},scales:{xAxes:[{gridLines:{drawBorder:!0,color:this.skin.lineColor},ticks:{fontColor:this.skin.fontColor}}],yAxes:[{gridLines:{drawBorder:!0,color:this.skin.lineColor},ticks:{fontColor:this.skin.fontColor}}]},maintenanceAspectRatio:!1}};null!=this.param.labels&&0!=this.param.labels.length?null!=this.param.datas&&0!=this.param.datas.length?(this.param.title.show&&(this.layout.padding.top=0),_.each(this.param.datas,function(t,e){n.data.datasets.push({label:t.label,data:t.data,backgroundColor:a.gradient[e],borderColor:a.color[e],pointBackgroundColor:"#FFF",pointRadius:4,borderWidth:2,fill:!0})}),new Chart(this.ctx,n)):console.log("请指定图表具体数据"):console.log("请指定图表X轴")}},{key:"_pie",value:function(){var a=this;this.tooltips.mode="nearest";var n={type:"pie",data:{labels:this.param.labels,datasets:[{data:[],backgroundColor:[],borderColor:[],borderWidth:2}]},options:{hover:"",tooltips:this.tooltips,title:{display:this.param.title.show,fontSize:14,text:this.param.title.text,fontColor:this.skin.fontColor,padding:0},responsive:this.param.responsive,maintainAspectRatio:this.param.responsive,legend:{display:this.param.legend,labels:{fontColor:this.skin.fontColor}},maintenanceAspectRatio:!1}};null!=this.param.labels&&0!=this.param.labels.length?null!=this.param.datas&&0!=this.param.datas.length?(this.param.title.show&&(this.layout.padding.top=0),_.each(this.param.datas,function(t,e){n.data.datasets[0].data.push(t),n.data.datasets[0].backgroundColor.push(a.gradient[e]),n.data.datasets[0].borderColor.push(a.color[e])}),new Chart(this.ctx,n)):console.log("请指定图表具体数据"):console.log("请指定图表块")}}]),l}(),_createClass=function(){function n(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,a){return e&&n(t.prototype,e),a&&n(t,a),t}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Citypikcer=function(){function a(t,e){if(_classCallCheck(this,a),"undefined"==typeof city_data_init)return console.log("没有检测到城市选择器必须的城市数据"),!1;this.input=t,this.inputDom=scope(this.input),this.picker=null,this.index=0,this.scrollTop=0,this.init=!1,this.level=1,this.prov=0;if(this.param=$.extend({type:1,format:" / ",level:3,change:null},e),0==this.inputDom.length)return console.log("当前页面中不包含"+this.input+"元素，创建失败"),!1;this.run()}return _createClass(a,[{key:"run",value:function(){this._create(),this._event()}},{key:"_create",value:function(){var t=[createId(),""],e=t[0],a=t[1];null!=Mount.window&&(a=null==(a=$("#"+Mount.window).css("z-index"))?"":"z-index:"+a+";");t='<div id="citypicker-'+e+'" class="citypicker animated faster'+(null==Mount.window?"":" "+Mount.window)+'"';1==this.param.type?(t+=' style="width:472px;'+a+'">',t+='<span class="title">Tips：输入城市拼音首字母可快速选择，例如：hf</span>\n\t\t\t<div class="header">\n\t\t\t\t<span class="current">热门</span>\n\t\t\t\t<span>ABC</span>\n\t\t\t\t<span>DEF</span>\n\t\t\t\t<span>GHI</span>\n\t\t\t\t<span>JKL</span>\n\t\t\t\t<span>MNO</span>\n\t\t\t\t<span>PQR</span>\n\t\t\t\t<span>STU</span>\n\t\t\t\t<span>VWX</span>\n\t\t\t\t<span>YZ</span>\n\t\t\t</div>\n\t\t\t<div class="body"></div>\n\t\t\t<div class="quick iscroll dn"></div>'):t+='style="'+a+'"><div class="vert iscroll"></div>',t+="</div>",body.append(t),this.picker=$("#citypicker-"+e),2==this.param.type&&this.picker.css("padding","5px")}},{key:"_event",value:function(){var n=this,t=[".header span:not(.current):not(.not-allow)",".body span, .quick span",".vert span"],e=[n.picker.children(".body"),n.picker.children(".quick")],i=e[0],l=e[1];1!=n.param.type&&(i=n.picker.children(".vert")),this.inputDom.on("focus",function(){n.init||(n._formatData(i),n.init=!0),fadeIn(n.picker,$(this),!1),clear=!0}).on("blur",function(){n.focus||(fadeOut(n.picker),clear=!1)}),keyup(this.inputDom,function(t,e){var a={val:t.val(),key:e.keyCode,html:""};if(1==n.param.type)return""!=a.val&&(64<a.key&&a.key<91||8==a.key||32==a.key)?(n.picker.is(":hidden")&&fadeIn(n.picker,t,!1),l.is(":hidden")&&(n.picker.data("left",n.picker.css("left")).css("left",t.offset().left).width(158).children(".title").html(" ↑ ↓ 键快速选择城市"),n.picker.children(".header, .body").hide(),l.show()),$.each(cp_b,function(t,e){-1!=e.indexOf(a.val)&&(e=e.split("@"),a.html+="<span>"+e[0]+"</span>")}),void l.html(a.html)):void(""==a.val&&n._reset());n.level=1,i.eq(0).nextAll(".vert").remove(),""!=a.val?(a.html=a.icon="",2==n.param.type&&1<n.param.level&&(a.icon='<i class="ri-arrow-right-s-line"></i>'),$.each(cp_d,function(t,e){-1!=e.indexOf(a.val)&&(e=e.split("@"),a.html+='<span data-c="'+e[0]+'" data-i="'+t+'">'+e[0]+a.icon+"</span>")}),i.eq(0).html(a.html)):n._formatData(i)}),1==n.param.type&&n.inputDom.on("keydown",function(t){var e;-1==_.indexOf([13,38,40],t.keyCode)||l.is(":hidden")||(e=l.children("span"),13!=t.keyCode?(38==t.keyCode&&(n.index<0&&(n.index=e.length-1),--n.index),40==t.keyCode&&(n.index!=e.length-1&&0!=l.children(".current").length||(n.index=-1),n.index+=1),n.index<0&&(n.scrollTop=l[0].scrollHeight-l.height(),l.scrollTop(n.scrollTop)),0==n.index&&(n.scrollTop=0,l.scrollTop(0)),e.eq(n.index).addClass("current").siblings().removeClass("current"),200<(t=e.eq(n.index).position().top)&&0<=n.index?(n.scrollTop+=215,l.scrollTop(n.scrollTop)):t<=0&&(n.scrollTop-=215,l.scrollTop(n.scrollTop))):n._setVal(e.eq(n.index).html()))}),n.picker.on("blur",function(){n.inputDom.blur(),fadeOut(n.picker),clear=!1}).on("click",t[0],function(){var t=$(this);addClassExc(t,"current"),n._formatData(i,cp_a[t.index()])}).on("click",t[1],function(){n._setVal($(this).html())}).on("click",t[2],function(){var t=[$(this),{}],e=t[0],a=t[1];if(a.val=e.data("c"),1!=n.param.level){if(addClassExc(e,"current"),a.parent=e.parent(),n.level=a.parent.index()+1,n.level==n.param.level)return a.val=a.doc="",n.picker.find(".current").each(function(){a.val+=a.doc+$(this).data("c"),a.doc=n.param.format}),void n._setVal(a.val);a.parent.nextAll(".vert").remove(),a.index=e.data("i"),a.next=a.parent.next(".vert"),0==a.next.length&&(n.level+=1,n.picker.append('<div class="vert"></div>'),a.next=n.picker.children(".vert:last"),Eadmin.scroll(a.next[0])),a.source=null,2==n.level?(n.prov=a.index,a.source=cp_c[a.index].sub):a.source=cp_c[n.prov].sub[a.index].sub,n._formatData(a.next,a.source,!0)}else n._setVal(a.val)}).on("mousedown",function(t){t.preventDefault()})}},{key:"_formatData",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,a=void 0;if(null!=e)if(a=[],2<arguments.length&&void 0!==arguments[2]&&arguments[2])for(var n in e)a[n]=e[n].name;else a=e;else if(1==this.param.type)a=cp_a[0];else for(var i in a=[],cp_c)a[i]=cp_c[i].name;var l,s="",r="";for(l in 2==this.param.type&&this.level<this.param.level&&(r='<i class="ri-arrow-right-s-line"></i>'),a)s+='<span data-c="'+a[l]+'" data-i="'+l+'">'+a[l]+r+"</span>";t.html(s)}},{key:"_setVal",value:function(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";this.inputDom.val(e),this.focus=!1,this.picker.trigger("blur"),this._callback(e),2!=this.param.type&&(this.picker.children(".quick").is(":hidden")||setTimeout(function(){t._reset()},500))}},{key:"_reset",value:function(){this.picker.width(450).children(".title").html("Tips：输入城市拼音首字母可快速选择，例如：hf"),null!=this.picker.data("left")&&this.picker.css("left",this.picker.data("left")),this.picker.children(".header, .body").show(),this.picker.children(".quick").hide()}},{key:"_callback",value:function(t){_.isFunction(this.param.change)&&this.param.change(t)}}]),a}(),_createClass=function(){function n(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,a){return e&&n(t.prototype,e),a&&n(t,a),t}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Colorpicker=function(){function a(t,e){_classCallCheck(this,a),this.domCache=scope(t),0!=this.domCache.length?(this.param=$.extend({color:["#FF2000","#90e200","#ffcf00","#ff7c00","#f52394","#00b2d4","#3366FF","#FF3E28"],change:null,bind:null,default:""},e),this.domCache.addClass("colorpicker"),this.run()):console.log("没有找到"+t+"元素，颜色选择器创建失败")}return _createClass(a,[{key:"run",value:function(){this._create(),this._event()}},{key:"_create",value:function(){if(0!=this.param.color.length){var t,e={html:""};for(t in this.param.color){var a="";this.param.color[t]==this.param.default&&(a='style="display:inline-block;"'),e.html+='<div data-color="'+this.param.color[t]+'">\n\t\t\t\t<div class="color" style="background:'+this.param.color[t]+'">\n\t\t\t\t</div>\n\t\t\t\t<i class="ri-check-line"'+a+"></i>\n\t\t\t</div>"}null!=this.param.bind&&(e.html+='<input \n\t\t\t\t\t\t\ttype="hidden" \n\t\t\t\t\t\t\tvalue="'+this.param.default+'" \n\t\t\t\t\t\t\tname="'+this.param.bind+'" \n\t\t\t\t\t\t\tid="colorpicker-input-'+this.param.bind+'"\n\t\t\t\t\t\t>'),this.domCache.html(e.html)}}},{key:"_event",value:function(){var a=this;this.domCache.on("click",">div:not(.active)",function(){var t=[$(this),""],e=t[0];a.domCache.find("i").hide(),a.domCache.children("input").val(e.data("color")),addClassExc(e,"active"),e.children("i").show(),t=e.data("color"),null!=a.param.bind&&$("#colorpicker-input-"+a.param.bind).val(t),_.isFunction(a.param.change)&&a.param.change(t)})}}]),a}(),_createClass=function(){function n(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,a){return e&&n(t.prototype,e),a&&n(t,a),t}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Datepikcer=function(){function a(t,e){_classCallCheck(this,a),this.date=new Date,this._reset(),this.today=parseInt(this.arr[0].y+""+this.arr[0].m+this.arr[0].d),this.time=!1,this.picker=null,this.input=t,this.inputDom=scope(this.input),this.index=0,this.pindex=null,this.currentNum=0,this.focusInput=null;if(this.param=$.extend({type:"date",format:"Y-m-d",confirm:!1,change:null,start:0,end:0,quick:!1,unixtime:!1,default:[]},e),0==this.inputDom.length)return console.log("当前页面中不包含"+this.input+"元素，创建日历失败"),!1;this.run()}return _createClass(a,[{key:"run",value:function(){this._create(),this._init(),this._event()}},{key:"_create",value:function(){var t=[createId(),""],e=t[0],t=t[1],t='<div id="datepicker-'+e+'" '+(t=null!=Mount.window?null==(t=$("#"+Mount.window).css("z-index"))?"":'style="z-index:'+t+';"':t)+' class="datepicker animated faster'+(null==Mount.window?"":" "+Mount.window)+'">';t+='<div class="quick">\n\t\t\t<span class="title">快捷选择</span>\n\t\t\t<span>3天内</span>\n\t\t\t<span>一周内</span>\n\t\t\t<span>15天内</span>\n\t\t\t<span>一月内</span>\n\t\t\t<span>三月内</span>\n\t\t\t<span>一年内</span>\n\t\t</div>\n\t\t<div class="datepicker-panel" data-index="0">\n\t\t<div class="header">\n\t\t\t<span class="prev-year">\n\t\t\t\t<i class="ri-arrow-left-s-line"></i>\n\t\t\t</span>\n\t\t\t<span class="prev-month">\n\t\t\t\t<i class="ri-arrow-drop-left-line"></i>\n\t\t\t</span>\n\t\t\t<span class="show-ym">\n\t\t\t\t<span class="font year" style="margin-right:5px;"></span>\n\t\t\t\t<span class="font month"></span>\n\t\t\t</span>\n\t\t\t<span class="next-year">\n\t\t\t\t<i class="ri-arrow-right-s-line"></i>\n\t\t\t</span>\n\t\t\t<span class="next-month">\n\t\t\t\t<i class="ri-arrow-drop-right-line"></i>\n\t\t\t</span>',t+='</div>\n\t\t\t<div class="body">\n\t\t\t\t<div class="week">\n\t\t\t\t\t'+this._week()+'\n\t\t\t\t</div>\n\t\t\t\t<div class="day"></div>',t+='<div class="y-m">\n\t\t\t'+this._year()+'\n\t\t</div>\n\t\t<div class="y-m">\n\t\t\t'+this._month()+"\n\t\t</div>",-1!=this.param.format.indexOf(" ")&&(t+='<div class="picker-time">\n\t\t\t\t\t\t'+this._time()+"\n\t\t\t\t\t</div>"),t+="</div></div>",t+='<div class="datepicker-panel right" data-index="1">\n\t\t<div class="header">\n\t\t\t<span class="prev-year">\n\t\t\t\t<i class="ri-arrow-left-s-line"></i>\n\t\t\t</span>\n\t\t\t<span class="prev-month">\n\t\t\t\t<i class="ri-arrow-drop-left-line"></i>\n\t\t\t</span>\n\t\t\t<span class="show-ym">\n\t\t\t\t<span class="font year" style="margin-right:5px;"></span>\n\t\t\t\t<span class="font month"></span>\n\t\t\t</span>\n\t\t\t<span class="next-year">\n\t\t\t\t<i class="ri-arrow-right-s-line"></i>\n\t\t\t</span>\n\t\t\t<span class="next-month">\n\t\t\t\t<i class="ri-arrow-drop-right-line"></i>\n\t\t\t</span>\n\t\t</div>\n\t\t<div class="body">\n\t\t\t<div class="week">\n\t\t\t\t'+this._week()+'\n\t\t\t</div>\n\t\t\t<div class="day"></div>',t+='<div class="y-m">\n\t\t\t'+this._year(parseInt(this.arr[0].m)+1)+'\n\t\t</div>\n\t\t<div class="y-m">\n\t\t\t'+this._month(parseInt(this.arr[0].m)+1)+"\n\t\t</div>",-1!=this.param.format.indexOf(" ")&&(t+='<div class="picker-time">\n\t\t\t\t\t\t'+this._time()+"\n\t\t\t\t\t</div>"),t+="</div></div>",t+='<div class="clear"></div>',t+='<div class="footer">\n\t\t\t<span class="font choose-time">\n\t\t\t\t选择时间\n\t\t\t</span>\n\t\t\t<span class="confirm">\n\t\t\t\t<button class="clear small">清空</button>\n\t\t\t\t<button class="hl small sure">确定</button>\n\t\t\t</span>\n\t\t</div>',t+="</div>",body.append(t),this.picker=$("#datepicker-"+e)}},{key:"_init",value:function(){var a=this;if(this.param.quick&&this.picker.find(".quick").show(),-1!=this.param.format.indexOf(" ")&&(this.time=!0),0<this.param.default.length){var t,e="",e=_.replace(this.param.format,"Y","%y");for(t in e=_.replace(e,"m","%M"),e=_.replace(e,"d","%d"),this.time&&(e=_.replace(e,"H","%h"),e=_.replace(e,"i","%m"),e=_.replace(e,"s","%s")),this.param.unixtime&&this.inputDom.data("default-date",_.join(this.param.default,",")),this.param.default)""!=e&&(this.param.default[t]=Time(this.param.default[t],e));this.param.unixtime||this.inputDom.data("default-date",_.join(this.param.default,",")),this.inputDom.val(_.join(this.param.default," - "))}var n={val:this.inputDom.val(),picker:this.picker.children("div").eq(1)};n.header=n.picker.children(".header");var i=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:n.header,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:a.arr[0].y;t.find(".year").data("y",e).html(e+"年")},l=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:n.header,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:a.arr[0].m;t.find(".month").data("m",e).html(e+"月")};i(),l(),n.picker.find(".day").html(this._createYmdHtml(this.arr[0].y,this.arr[0].m)),"date-range"==this.param.type&&(n.range=n.picker.next(),n.range.show(),n.rangeHeader=n.range.children(".header"),i(n.rangeHeader,this.arr[1].y),l(n.rangeHeader,this.arr[1].m),n.range.find(".day").html(this._createYmdHtml(this.arr[1].y,this.arr[1].m))),this.param.confirm&&this.picker.find(".footer").show(),this.time&&(n.chooseTime=this.picker.find(".choose-time"),n.chooseTime.show(),n.arr=_.words(this.param.format,/[His]/g),n.arr.length<2?console.log("日期如果包含时间的话则至少需要时和分两个参数"):(""!=n.val&&(n.picker.find(".h"+this.h).addClass("current"),n.picker.find(".i"+this.i).addClass("current"),n.picker.find(".s"+this.s).addClass("current")),2==n.arr.length&&(n.picker.find(".picker-time ul:last").remove(),"date-range"==this.param.type&&n.range.find(".picker-time ul:last").remove())))}},{key:"_reset",value:function(){var t=0<arguments.length&&void 0!==arguments[0]&&arguments[0];this.arr=[{y:this.date.getFullYear(),m:this.date.getMonth(),d:this.date.getDate(),h:"00",i:"00",s:"00",c:0,index:0},{y:this.date.getFullYear(),m:this.date.getMonth(),d:this.date.getDate(),h:"00",i:"00",s:"00",c:0,index:1}],this.arr[1].m+=1,12==this.arr[1].m&&(this.arr[1].y+=1,this.arr[1].m=0),this.arr[0].m=repairZero(parseInt(this.arr[0].m)+1),this.arr[0].d=repairZero(this.arr[0].d),this.arr[1].m=repairZero(parseInt(this.arr[1].m)+1),this.arr[1].d=repairZero(this.arr[1].d),t&&((t={ym:this.picker.find(".show-ym"),day:this.picker.find(".day")}).y=t.ym.eq(0).children(".year"),t.m=t.ym.eq(0).children(".month"),t.y.data("y")!=this.arr[0].y&&t.y.html(this.arr[0].y+"年").data("y",this.arr[0].y),t.m.data("m")!=this.arr[0].m&&t.m.html(this.arr[0].m+"月").data("m",this.arr[0].m),t.y==this.arr[0].y&&t.m==this.arr[0].m||t.day.eq(0).html(this._createYmdHtml(this.arr[0].y,this.arr[0].m)),"date-range"==this.param.type&&(t.y=t.ym.eq(1).children(".year"),t.m=t.ym.eq(1).children(".month"),t.y.data("y")!=this.arr[1].y&&t.y.html(this.arr[1].y+"年").data("y",this.arr[1].y),t.m.data("m")!=this.arr[1].m&&t.m.html(this.arr[1].m+"月").data("m",this.arr[1].m),t.y==this.arr[1].y&&t.m==this.arr[1].m||t.day.eq(1).html(this._createYmdHtml(this.arr[1].y,this.arr[1].m))))}},{key:"_createYmdHtml",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",a=parseInt(e)-1,n={firstWeekDay:new Date(t,a,1).getDay(),monthDay:this._getMonthDay(t,a),prevMonthDay:this._getMonthDay(t,a-1),realDay:1,start:this.param.start?parseInt(this.param.start):0,end:this.param.end?parseInt(this.param.end):0,html:""};n.firstWeekDay+=1;for(var i=1;i<43;i++){var l,s="",r="",o=0;i<n.firstWeekDay?(n.realDay=n.prevMonthDay-(n.firstWeekDay-i),n.realDay+=1,r=' class="next"'):i-n.firstWeekDay>=n.monthDay?(i-n.firstWeekDay==n.monthDay&&(n.realDay=1),r=' class="next"'):((o=parseInt(t+""+e+repairZero(i-n.firstWeekDay+1)))==this.today&&(s="<div></div>"),"date"==this.param.type?o==this.arr[this.index].c&&(r=' class="current"'):(this.arr[this.index].index==this.index&&this.arr[this.index].c==o&&(r=' class="current"'),l=1==this.index?0:1,this.arr[l].index==this.index&&this.arr[l].c==o&&(r=' class="current"')),i==n.firstWeekDay&&(n.realDay=1)),(0<n.start||0<n.end)&&' class="next"'!=r&&(0<n.start&&o<n.start&&(r=' class="next"'),0<n.end&&o>n.end&&(r=' class="next"')),n.html+="<span"+r+' data-day="'+o+'" data-y="'+t+'" data-m="'+e+'" data-d="'+n.realDay+'">\n\t\t\t\t\t\t\t'+s+n.realDay+"\n\t\t\t\t\t\t</span>",n.realDay++}return n.html}},{key:"_getMonthDay",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",e=(e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"")<0?11:e,a=t%4==0&&t%100!=0||t%400==0?29:28,t=new Array;return t[0]=31,t[1]=a,t[2]=31,t[3]=30,t[4]=31,t[5]=30,t[6]=31,t[7]=31,t[8]=30,t[9]=31,t[10]=30,t[11]=31,t[e]}},{key:"_week",value:function(){var t,e="",a=["日","一","二","三","四","五","六"];for(t in a)e+="<span>"+a[t]+"</span>";return e}},{key:"_year",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",e=parseInt(this.arr[0].y);12===t&&(e+=1);for(var a="",n=e+1;n>parseInt(this.arr[0].y)-11;n--)a+='<div class="year'+(e==n?" active":"")+'" data-y="'+n+'">'+n+"</div>";return a}},{key:"_month",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",e=""==t?+this.arr[0].m:t;12<e&&(e=1);for(var a="",n=1;n<13;n++)a+='<div class="month'+(e==n?" active":"")+'" data-m="'+n+'">'+n+"月</div>";return a}},{key:"_time",value:function(){for(var t='<ul class="iscroll">',e=0;e<24;e++)t+='<li class="h'+(e=repairZero(e))+' h">'+e+"</li>";t+='</ul><ul class="i iscroll">';for(var a=0;a<60;a++)t+='<li class="i'+(a=repairZero(a))+' i">'+a+"</li>";t+='</ul><ul class="s iscroll">';for(var n=0;n<60;n++)t+='<li class="s'+(n=repairZero(n))+' s">'+n+"</li>";return t+="</ul>"}},{key:"_event",value:function(){var t=[".prev-year, .prev-month, .next-year, .next-month",".show-ym .year, .show-ym .month",".y-m div",".day span",".footer .clear",".footer .sure",".footer .choose-time",".picker-time li",".quick span"],c=this;c.inputDom.on("focus",function(){var t=$(this);fadeIn(c.picker,t,!1),c.focusInput=t,clear=!0}).on("blur",function(){fadeOut(c.picker),c.focusInput=null,clear=!1;var t=$(this);""==t.val()&&0!=t.next("input").length&&t.next("input").val("")}),this.picker.on("blur",function(){c.focusInput.blur(),c.focusInput=null,fadeOut(c.picker),clear=!1}).on("mouseenter",">.datepicker-panel",function(){c.index=$(this).data("index")}).on("click",t[0],function(){var t=$(this),e={body:t.parent().next(".body"),ym:t.siblings(".show-ym")};e.y=e.ym.children(".year").data("y"),e.m=parseInt(e.ym.children(".month").data("m"));var a=function(){e.ym.children(".year").data("y",e.y).html(e.y+"年")};t.hasClass("prev-year")?(--e.y,a()):t.hasClass("prev-month")?(--e.m,0==e.m&&(--e.y,e.m=12,a()),e.ym.children(".month").html(repairZero(e.m)+"月").data("m",e.m)):t.hasClass("next-year")?(e.y+=1,a()):(e.m+=1,13==e.m&&(e.y+=1,e.m=1,a()),e.ym.children(".month").html(repairZero(e.m)+"月").data("m",e.m)),e.body.children(".day").html(c._createYmdHtml(e.y,repairZero(e.m)))}).on("click",t[1],function(){var t=$(this);t.parent().children(".month").hide();var e=t.parent().parent().next(".body");e.children("div").hide();t=$(this).hasClass("year")?2:3;e.children().eq(t).css("display","flex")}).on("click",t[2],function(){var t,e,a=$(this),n=a.parent().parent(),i=n.prev();a.hasClass("year")?(e=a.data("y"),i.find(".year").html(e+"年").data("y",e),a.parent().hide().next().css("display","flex")):(t=i.find(".year").data("y"),e=a.data("m"),a.parent().hide().siblings(".week, .day").css("display","flex"),i.find(".month").html(repairZero(e)+"月").data("m",e).show(),n.children(".day").html(c._createYmdHtml(t,repairZero(e)))),addClassExc(a,"active")}).on("click",t[3],function(){var t=$(this);if(!t.hasClass("next")){if("date-range"==c.param.type){var e=c.index;if(c.arr[e].y=t.data("y"),c.arr[e].m=t.data("m"),c.arr[e].index=c.index,c.currentNum+=1,3==c.currentNum&&(c.picker.find(".current").removeClass("current"),c.currentNum=1,c.pindex=null),t.addClass("current"),null==c.pindex?c.pindex=e:e==c.pindex&&(e=0==c.pindex?1:0,c.arr[e].y=c.arr[c.pindex].y,c.arr[e].m=c.arr[c.pindex].m,c.arr[e].index=c.index),c.arr[e].d=repairZero(t.data("d")),c.arr[e].c=parseInt(t.data("day")),1==c.currentNum||3==c.currentNum)return}else c.arr[0].y=t.data("y"),c.arr[0].m=t.data("m"),c.arr[0].d=repairZero(t.data("d")),c.arr[0].c=parseInt(t.data("day")),addClassExc(t,"current");c.param.confirm||c._setVal()}}).on("click",t[4],function(){c.inputDom.val(""),c.picker.find(".current").removeClass("current"),c._reset(!0),c.focus=!1,c.picker.trigger("blur")}).on("click",t[5],function(){c._setVal()}).on("click",t[6],function(){var t=$(this);if(t.hasClass("not-allow"))return!1;var e=t.data("type");if(null==e||0==e)return t.data("type",1).html("选择日期"),void $(c.picker).find(".body > div").hide().siblings(".picker-time").css("display","flex");t.data("type",0).html("选择时间"),$(c.picker).find(".body > .week, .body > .day").css("display","flex").siblings(".picker-time").hide()}).on("click",t[7],function(){var t=$(this),e=t.position().top+t.parent()[0].scrollTop;c.time&&(t.hasClass("h")?c.arr[c.index].h=t.html():t.hasClass("i")?c.arr[c.index].i=t.html():c.arr[c.index].s=t.html()),t.addClass("current").siblings().removeClass("current").parent().animate({scrollTop:e},200),2!=t.parent().index()&&t.parent().next("ul").children("li:first").trigger("click")}).on("click",t[8],function(){var t=$(this);if(0!=t.index()&&!t.hasClass("current")){var n=c.date.getFullYear(),i=repairZero(c.date.getMonth()+1),e=c.date.getDate(),a=0;switch(t.index()){case 1:a=3;break;case 2:a=7;break;case 3:a=15;break;case 4:a=30;break;case 5:a=90;break;case 6:a=365}var l=Date.parse((new Date).toString())-864e5*a,s=new Date(l),r=s.getFullYear(),o=repairZero(s.getMonth()+1),l=s.getDate(),s=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;c.index=0;var e=c._createYmdHtml(r,o);c.picker.children("div").eq(1).find(".day").html(e),c.picker.find(".show-ym:first").children(".year").html(r+"年").data("y",r).next().html(o+"月").data("m",o),c.index=1;var a=n,t=parseInt(i)+t;12<t&&(a+=t=1),t=repairZero(t),e=c._createYmdHtml(a,t),c.picker.children("div").eq(2).find(".day").html(e),c.picker.find(".show-ym:last").children(".year").html(a+"年").data("y",a).next().html(t+"月").data("m",t)};addClassExc(t,"current"),c.picker.find(".day .current").removeClass("current"),r==n&&o==i?(c.picker.find(".day:first").children('[data-d="'+e+'"]:not(.next),[data-d="'+l+'"]:not(.next)').addClass("current"),c.arr[0].y=r,c.arr[0].m=i,l=repairZero(l),c.arr[0].d=l,c.arr[0].c=parseInt(n+""+i+l),c.arr[1].y=n,c.arr[1].m=i,e=repairZero(e),c.arr[1].d=e,c.arr[1].c=parseInt(n+""+i+e),c.arr[1].index=0,c.pindex=0,(t=c.picker.find(".show-ym:first")).children(".year").data("y")==n&&t.children(".month").data("m")==i||s(1)):(c.arr[0].y=r,c.arr[0].m=o,l=repairZero(l),c.arr[0].d=l,c.arr[0].c=parseInt(r+""+o+l),c.arr[1].y=n,c.arr[1].m=i,e=repairZero(e),c.arr[1].d=e,c.arr[1].c=parseInt(n+""+i+e),c.arr[1].index=1,c.pindex=1,s()),c.currentNum=2,c.param.confirm||c._setVal()}}).on("mousedown",function(t){t.preventDefault()})}},{key:"_setVal",value:function(){var t,a=this,e="",n=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,t={index:a.arr[t],val:""};return t.m=t.index.m,t.d=t.index.d,0==e?(t.val=_.replace(a.param.format,"Y",t.index.y),t.val=_.replace(t.val,"m",t.m),t.val=_.replace(t.val,"d",t.d),a.time&&(t.val=_.replace(t.val,"H",t.index.h),t.val=_.replace(t.val,"i",t.index.i),t.val=_.replace(t.val,"s",t.index.s)),t.val):(t.val=t.index.y+""+t.m+t.d,parseInt(t.val))};"date"==this.param.type?(e=n(),0==this.arr[0].c&&(this.arr[this.index].c=n(0,1),this.picker.find(".day").find('span[data-d="'+parseInt(this.arr[0].d)+'"]:not(.next)').addClass("current")),this.focusInput.val(e),this.param.unixtime&&(this.time||(e+=" 00:00:00"),e=Date.parse(new Date(e))/1e3),0==this.focusInput.next("input").length?null==(t=this.focusInput.attr("name"))?console.log("没有为日期文本框指定name属性，这将影响后端取值"):this.focusInput.removeAttr("name").after('<input type="hidden" name="'+t+'" value="'+e+'">'):this.focusInput.next("input").val(e)):(this.pindex=null,0!=this.arr[0].c&&0!=this.arr[1].c||(0==this.arr[0].c&&(this.arr[0].c=n(0,1)),0==this.arr[1].c&&(this.arr[1].c=n(1,1)),this.picker.find(".day").find('span[data-d="'+parseInt(this.arr[0].d)+'"]:not(.next)').addClass("current"),this.currentNum=2),t=this.arr[0].c>this.arr[1].c?n(1):n(),n=this.arr[0].c>this.arr[1].c?n():n(1),this.focusInput.val(e+=t+" - "+n),this.param.unixtime&&(this.time||(t+=" 00:00:00",n+=" 23:59:59"),t=Date.parse(new Date(t))/1e3,n=Date.parse(new Date(n))/1e3),e=t+","+n,0==this.focusInput.next("input").length?null==(n=this.focusInput.attr("name"))?console.log("没有为日期文本框指定name属性，这将影响后端取值"):this.focusInput.removeAttr("name").after('<input type="hidden" name="'+n+'" value="'+e+'">'):this.focusInput.next("input").val(e)),this.focus=!1,this.picker.trigger("blur"),1<this.inputDom.length&&this._reset(!0),_.isFunction(this.param.change)&&this.param.change(e)}}]),a}(),_createClass=function(){function n(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,a){return e&&n(t.prototype,e),a&&n(t,a),t}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Dropdown=function(){function a(t,e){_classCallCheck(this,a),this.dom=t,this.dropdown=null;this.param=$.extend({width:0,trigger:"click",fixed:!1,title:"",data:[]},e),0!=this.param.data.length?this.run():console.log("没有配置下拉菜单数据项，创建失败")}return _createClass(a,[{key:"run",value:function(){this._create(),this._event()}},{key:"_create",value:function(){var t="dropdown-"+createId(),i="",e="";null!=Mount.window&&(e=null==(e=$("#"+Mount.window).css("z-index"))?"":"z-index:"+e+";"),i='<div id="'+t+'" class="dropdown animated faster'+(this.param.fixed?" fixed":"")+'" style="',0<this.param.width&&(i+=" width:"+this.param.width+"px;"+e),i+='">',""!=this.param.title&&(i+='<div class="title">'+this.param.title+"</div>"),i+='<ul class="iscroll">',_.each(this.param.data,function(t){var e=t.icon?'<i class="'+t.icon+'"></i>':"",a=t.disabled?' class="disabled"':"",n=!0===t.checked?"":" dn";t.divided?i+='<li class="divided"></li>':i+="<li"+a+">\n\t\t\t\t\t\t"+e+"<span>"+t.name+'</span>\n\t\t\t\t\t\t<i class="ri-check-line checked'+n+'"></i>\n\t\t\t\t\t</li>'}),i+="</ul></div>",body.append(i),this.dropdown=$("#"+t)}},{key:"_event",value:function(){var n=this,a=-1!=["click","contextMenu"].indexOf(this.param.trigger)?"mousedown":"mouseenter",i=null;body.on(a,this.dom,function(t){var e=$(this);if(!("click"==n.param.trigger&&1!=t.which||"contextMenu"==n.param.trigger&&3!=t.which))return e.on("contextmenu",function(t){return!1}),fadeIn(n.dropdown,e),n.dropdown.data("active",1),"mousedown"==a&&n.dropdown.trigger("focus"),"mouseenter"==a&&null!=i&&clearTimeout(i),!(clear=!0)}).on("mouseleave",this.dom,function(){n.dropdown.data("active",0),"mouseenter"==a&&(i=setTimeout(function(){fadeOut(n.dropdown),clear=!1},500))}),"mousedown"==a&&n.dropdown.on("blur",function(){var t=$(this);1!=t.data("active")&&(fadeOut(t),clear=!1)}),"mouseenter"==a&&n.dropdown.on("mouseenter",function(){clearTimeout(i)}).on("mouseleave",function(){i=setTimeout(function(){fadeOut(n.dropdown),clear=!1},500)}),n.dropdown.on("click","li:not(.disabled):not(.divided)",function(){var t=$(this),e=t.index(),a=n.param.data[e];null!=a.checked&&(a.checked=!a.checked,a.checked?t.children(".checked").show():t.children(".checked").hide()),_.isFunction(a.click)&&((t=a.custom||{})._index=e,t._checked=null==a.checked?null:a.checked,a.click(t),null==a.checked&&n.dropdown.hide())})}}]),a}(),_createClass=function(){function n(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,a){return e&&n(t.prototype,e),a&&n(t,a),t}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Editor=function(){function a(t,e){if(_classCallCheck(this,a),this.storeKey=md5(Eadmin.currentHref+t),this.dom=t,this.domCache=scope(this.dom),this.dom+=(new Date).valueOf(),null==this.domCache.data("name"))return console.log("请为富文本编辑框指定data-name属性，用来后端取值"),!1;t=this.domCache.html();this.domCache.attr("id",this.dom.replace("#","")).data("store",this.storeKey).addClass("editor").after('<input type="hidden" name="'+this.domCache.data("name")+'">');this.param=$.extend(!0,{name:"editor",height:300,readonly:!1,placeholder:"请输入内容...",doc:[".jpg",".png",".jpeg",".gif"],size:1e3,api:"upload.php",filename:"file",autosave:!1,savetime:3},e),""!=this.param.api?(_.startsWith(this.param.api,"http")||(this.param.api=module.conf.http.baseURL+this.param.api),this.domCache.css("min-height",this.param.height).after('<input class="dn" type="file" accept="image/*">'),""!=t||null!=(t=store(this.storeKey))&&this.domCache.html(t),this.quill=null,this.create()):console.log("请指定后端接收上传数据的API地址")}return _createClass(a,[{key:"create",value:function(){var t=this;this.quill=new Quill(this.dom,{theme:"snow",modules:{toolbar:[["bold","italic","underline","strike",{header:[1,2,3,4,5,6,!1]}],[{size:["small",!1,"large","huge"]}],[{color:[]},{background:[]}],["blockquote","code-block"],[{list:"ordered"},{list:"bullet"}],[{indent:"-1"},{indent:"+1"}],[{align:[]}],[{direction:"rtl"}],["clean","link","image","video"]]},placeholder:this.param.placeholder,readOnly:this.param.readonly}),this.domCache.next().next("input[type='hidden']").val(this.quill.root.innerHTML);var e=this.domCache.next("input[type='file']");this.quill.getModule("toolbar").addHandler("image",function(){e.val("").trigger("click")});var a=this;e.on("change",function(t){var e=t.target.files[0],t=e.type.replace(/image\//,".");-1!=a.param.doc.indexOf(t)?(a.param.size*=1e3,e.size>a.param.size?Eadmin.message.error({content:"图片大小超出限制，上传失败"}):((t=new FormData).append(a.param.filename,e,e.name),module.conf.http.headers["Content-Type"]="multipart/form-data",Eadmin.post({url:a.param.api,form:t,then:function(t){var e=a.quill.getSelection(),e=0+(null!==e?e.index:0);a.quill.insertEmbed(e,"image",t.pic),a.quill.setSelection(1+e)}}))):Eadmin.message.error({content:"图片格式不允许，上传失败"})}),this.param.autosave&&(this.quill.on("text-change",_.debounce(function(){store(t.storeKey,t.quill.root.innerHTML),Eadmin.message.info({content:"编辑内容已实时保存至本地"})},1e3*this.param.savetime)),this.quill.on("text-change",function(){t.domCache.next().next("input[type='hidden']").val(t.quill.root.innerHTML)}))}}]),a}(),_createClass=function(){function n(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,a){return e&&n(t.prototype,e),a&&n(t,a),t}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Form=function(){function t(){_classCallCheck(this,t)}return _createClass(t,null,[{key:"init",value:function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:null)||box,t=e.find('input[type="text"]');module.conf.close_autocomplete&&t.attr("autocomplete","off"),t.each(function(){var t,e=$(this),a={class:"icon-input",numinput:e.hasClass("num-input")};a.icon=e.data("icon"),null==a.icon||a.numinput||(-1!=a.icon.indexOf("|")&&(a.arr=a.icon.split("|"),a.icon=a.arr[0],a.class="right"==a.arr[1]?a.class+"-right":a.class),e.parent().is("label")?(e.before('<i class="'+a.icon+'"></i>'),e.parent().addClass(a.class)):(e.before('<label class="'+a.class+'"></label>'),a.label=e.prev("label"),$('<i class="'+a.icon+'"></i>').appendTo(a.label),e.appendTo(a.label))),a.prepend=e.data("prepend"),null!=a.prepend&&(t='<div class="input-group">\n\t\t\t\t\t\t\t\t<span class="prepend">'+a.prepend+"</span>\n\t\t\t\t\t\t\t</div>",e.before(t),e.appendTo(e.prev(".input-group"))),a.append=e.data("append"),null!=a.append&&(e.parent().is(".input-group")||(e.before('<div class="input-group"></div>'),e.appendTo(e.prev(".input-group"))),$('<span class="append">'+a.append+"</span>").appendTo(e.parent())),a.numinput&&(""==e.val()?(e.val(0),a.val=0):a.val=e.val(),a.min=e.data("min")||0,a.max=e.data("max")||0,a.add=0<a.max&&a.val>=a.max?"disabled":"",a.cut=a.val<=a.min?"disabled":"",a.html='<span class="num-add-cut">\n\t\t\t\t\t\t\t<i class="ri-arrow-up-s-line add '+a.add+'"></i>\n\t\t\t\t\t\t\t<i class="ri-arrow-down-s-line cut '+a.cut+'"></i>\n\t\t\t\t\t\t</span>',e.before('<div class="input-group"></div>'),a.group=e.prev(".input-group"),e.appendTo(a.group),$(a.html).appendTo(a.group),a.val<a.min&&e.val(a.min),0<a.max&&a.val>a.max&&e.val(a.max)),a.date=e.data("default-date"),null!=a.date&&0==e.next("input").length&&(null!=(t=e.attr("name"))?e.removeAttr("name").after('<input type="hidden" name="'+t+'" value="'+a.date+'">'):console.log("没有为日期文本框指定name属性，这将影响后端取值"))}),e.find("textarea[maxlength]").each(function(){var t=$(this),e=[t.attr("maxlength"),t.text().length],e='<span class="font-num">'+e[1]+" / "+e[0]+"</span>";t.addClass("no-resize textarea-max").after(e)});t=e.find("select:not([class^='ql-'])");0<t.length&&t.each(function(){var t=$(this),l={li:"",default:"",multiple:t.data("multiple"),disabled:"",class:"",index:t.find(":selected").index(),selected:null,txtArr:[]};null!=l.multiple&&(l.name=t.attr("name"),null==l.name&&console.log("下拉菜单上没有指定name,后端无法取值"),l.default=t.data("selected")||"",l.default=l.default.toString(),t.removeAttr("name").before('<input type="hidden" name="'+l.name+'" value="'+l.default+'">'),l.default=l.default.split(",")),t.is(":disabled")&&(l.disabled=" select-disabled"),l.class=0==l.index||""!=l.disabled?"":"selected",l.bind=t.data("bind"),null!=l.bind&&(l.child=e.find("#"+l.bind),0==l.child.length?console.log("没有找到绑定的ID为"+l.bind+"的子菜单"):""==l.class&&l.child.attr("disabled",!0)),null!=t.data("width")?(l.width=t.data("width"),_.endsWith(l.width,"%")||(l.width+="px")):l.width=t.outerWidth()+"px",t.children("option").each(function(t){var e=$(this),a=[e.val(),e.text(),""],n=a[0],i=a[1],a=a[2];if(0==t)return!0;e.is(":disabled")?a="disabled":e.is(":selected")&&(l.selected=t,null==l.bind&&(a="active")),null!=l.multiple&&((t="")!=l.default&&-1!=l.default.indexOf(n)&&(t=" checked",l.txtArr.push(i)),i='<label>\n\t\t\t\t\t\t\t\t\t<input type="checkbox" value="'+n+'" '+t+' data-txt="'+i+'"> '+i+"\n\t\t\t\t\t\t\t\t</label>",a+=" multiple"),l.li+='<li class="'+a+'" data-val="'+n+'">'+i+"</li>"}),null==l.multiple?l.txt=t.find(":selected").text():0==l.txtArr.length?l.txt="请选择":l.txt=_.join(l.txtArr,"、"),l.html='<div style="width:'+l.width+';" class="select'+l.disabled+'" data-open="0">\n\t\t\t\t\t\t\t\t<span class="'+l.class+'">'+l.txt+'</span>\n\t\t\t\t\t\t\t\t<i class="ri-arrow-down-s-line rotate-0"></i>\n\t\t\t\t\t\t\t\t<i class="ri-close-circle-fill select-clear"></i>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div style="width:'+l.width+';" class="select-option animated faster'+(null!=l.multiple?" select-multiple":"")+'">\n\t\t\t\t\t\t\t\t<ul class="iscroll">'+l.li+"</ul></div>",t.after(l.html),""!=l.class&&null!=l.bind&&t.next().next().find("li").eq(l.selected-1).trigger("click"),Mount.observer.observe(t[0],{attributeFilter:["disabled"]})});t=e.find(":radio");0<t.length&&t.each(function(){var t=$(this),e={class:"radio",model:t.data("model"),icon:["ri-radio-button-line","ri-checkbox-blank-circle-line"]};"switch"==e.model?(t.prop("checked",!0),e.checked="",1==t.val()&&(e.checked=" switch-open"),e.disabled=t.is(":disabled")?" switch-disabled":"",e.html='<div class="checkbox-switch'+e.checked+e.disabled+'">\n\t\t\t\t\t\t\t\t<span></span>\n\t\t\t\t\t\t\t</div>',t.parent().append(e.html)):(e.class+=t.is(":disabled")?"-disabled":"",e.class+=t.is(":checked")?"-checked":"","tag"==e.model?e.class+="-tag":t.before('<i class="'+(t.is(":checked")?e.icon[0]:e.icon[1])+'"></i>'),t.parent().addClass(e.class)),Mount.observer.observe(t[0],{attributeFilter:["disabled"]})});t=e.find(":checkbox");0<t.length&&t.each(function(){var t=$(this),e={class:"checkbox"};e.class+=t.is(":disabled")?"-disabled":"",e.class+=t.is(":checked")?"-checked":"",t.parent().addClass(e.class),e.icon=t.is(":checked")?"ri-checkbox-line":"ri-checkbox-blank-line",t.hasClass("checkbox-half")&&(e.icon="ri-checkbox-indeterminate-line"),e.html='<i class="'+e.icon+'"></i>',t.before(e.html),Mount.observer.observe(t[0],{attributeFilter:["disabled"]})})}},{key:"event",value:function(){var t=[".select:not(.select-disabled)",".select-option",".select-option li:not(.disabled):not(.active):not(.multiple)",".add, .cut",":radio",":checkbox",".checkbox-switch:not(.switch-disabled)",".select-multiple",".select-multiple :checkbox",".select-clear",".num-input"];body.on("click",t[0],function(){var t=$(this),e={p:t.position(),o:t.next(".select-option")};if(e.oHeight=e.o.outerHeight()+10,e.o.css("left",e.p.left),distance(t,"bottom")<e.oHeight&&e.o.css("top",e.p.top-e.oHeight),e.open=1==t.data("open")?0:1,t.data("open",e.open),e.i=t.children("i:first"),0==e.open)return e.i.removeClass("rotate-180").addClass("rotate-0"),void fadeOut(e.o);e.i.removeClass("rotate-0").addClass("rotate-180"),fadeIn(e.o),e.o.attr("tabindex",0).trigger("focus")}).on("mouseenter",t[0],function(){var t=$(this),e=t.prev().find(":selected").index();t.next(".select-option").data("active",1),0!=e&&t.find(".select-clear").show().prev().hide()}).on("mouseleave",t[0],function(){var t=$(this),e=t.prev().find(":selected").index();t.next(".select-option").data("active",0),0!=e&&t.find(".select-clear").hide().prev().show()}).on("mouseover",t[7],function(){$(this).data("active",1)}).on("mouseout",t[7],function(){$(this).data("active",0)}).on("blur",t[1],function(){var t=$(this);1!=t.data("active")&&(t.prev().data("open",0).children("i").removeClass("rotate-180").addClass("rotate-0"),fadeOut(t))}).on("click",t[2],function(){var t=$(this),a={val:t.data("val"),txt:t.html(),select:t.parent().parent().prev().prev()};if(a.first=a.select.find("option:first"),a.select.val(a.val).next().children("span").addClass("selected").html(a.txt),t.addClass("active").siblings(".active").removeClass("active"),t.parent().parent().trigger("blur"),a.select.trigger("change"),a.bind=a.select.data("bind"),null==a.bind)return!1;a.api=a.select.data("api"),null!=a.api&&""!=a.api?(a.child=$("#"+a.bind),a.child.next(".select").children("span").html('<i class="ri-loader-4-line rotate"></i>'),Eadmin.get({url:a.api+=a.val,then:function(t){var e=['<option value="'+a.first.val()+'">'+a.first.text()+"</option>","",a.child.data("selected"),a.first.text()],i=e[0],l=e[1],s=e[2],r=e[3];_.each(t,function(t,e){var a="",n="";e==s&&(a=" selected",n=' class="active"',r=t),i+='<option value="'+e+'"'+a+">"+t+"</option>",l+='<li data-val="'+e+'"'+n+">"+t+"</li>"}),a.child.html(i),a.child.attr("disabled",!1).next(".select").removeClass("select-disabled").children("span").html(r),a.child.next().next().children("ul").html(l)}})):console.log("没有设置子菜单数据调用的API地址")}).on("click",t[9],function(){var t=$(this),e={span:t.prev().prev()};return e.select=e.span.parent(),e.real=e.select.prev(),e.option=e.select.next(),e.first=e.real.find("option:first"),e.span.html(e.first.text()),e.real.val(e.first.val()),e.option.find(".active").removeClass("active"),t.hide(),1==e.select.data("open")?(t.prev().show().removeClass("rotate-180").addClass("rotate-0"),e.select.data("open",0),fadeOut(e.option)):t.prev().show(),e.bind=e.real.data("bind"),null==e.bind||(e.child=$("#"+e.bind),e.first=e.child.find("option:first"),e.child.attr("disabled",!0).val(e.first.val()),e.child.next().children("span").html(e.first.text())),!1}).on("click",t[8],function(){var e={txt:[],val:[],ul:$(this).parent().parent().parent()};e.ul.find(":checked").each(function(){var t=$(this);e.txt.push(t.data("txt")),e.val.push(t.val())}),e.txt=_.join(e.txt,"、"),e.val=_.join(e.val,","),e.select=e.ul.parent().prev(),""==e.txt&&(e.txt=e.select.prev().children("option:first").text()),e.select.children("span").html(e.txt),e.select.prev().prev().val(e.val)}).on("click",t[3],function(){var t=$(this);if(!t.hasClass("disabled")){var e={input:t.parent().prev()};if(!e.input.is(":disabled")){if(e.min=e.input.data("min")||0,e.max=e.input.data("max")||0,e.step=e.input.data("step")||1,e.val=+e.input.val(),t.hasClass("add"))return e.val+=+e.step,0<e.max&&e.val==e.max&&t.addClass("disabled"),e.input.val(e.val),void t.next().removeClass("disabled");e.val-=+e.step,e.val<=e.min&&t.addClass("disabled"),e.input.val(e.val),t.prev().removeClass("disabled")}}}).on("mousedown",t[3],function(t){t.preventDefault()}).on("blur",t[10],function(){var t=$(this),e={val:t.val(),min:t.data("min"),max:t.data("max"),btn:t.next().children("i")};if(null!=e.min&&e.val<e.min)return t.val(e.min),e.btn.eq(0).removeClass("disabled"),void e.btn.eq(1).addClass("disabled");null!=e.max&&e.val>e.max&&(t.val(e.max),e.btn.eq(0).addClass("disabled"),e.btn.eq(1).removeClass("disabled"))}).on("click",t[4],function(){var t=[$(this),{}],e=t[0],t=t[1];t.radio=e.parent(),t.icon=["ri-radio-button-line","ri-checkbox-blank-circle-line"],"switch"===e.data("model")||t.radio.hasClass("radio-checked")||t.radio.hasClass("radio-checked-tag")||("tag"!=e.data("model")?(t.radio.removeClass("radio").addClass("radio-checked").children("i").attr("class",t.icon[0]),t.radio.siblings(".radio-checked").addClass("radio").removeClass("radio-checked").children("i").attr("class",t.icon[1])):t.radio.attr("class","radio-checked-tag").siblings(".radio-checked-tag").attr("class","radio-tag"))}).on("click",t[5],function(){var t=$(this),e={checkbox:t.parent()};t.is(":checked")?e.checkbox.attr("class","checkbox-checked").children("i").attr("class","ri-checkbox-line"):(t.removeClass("checkbox-half"),e.checkbox.attr("class","checkbox").children("i").attr("class","ri-checkbox-blank-line"))}).on("click",t[6],function(){var t=$(this),e={radio:t.prev(":radio")};1==e.radio.val()?(t.removeClass("switch-open"),e.radio.val(0)):(t.addClass("switch-open"),e.radio.val(1))}).on("submit","form",function(){var a=$(this),n={action:a.attr("action")||Eadmin.currentHref};if(Validate.submit(a),0<a.find("span.error").length)return!1;if(n.submit=a.find("[data-submit]"),0<n.submit.length&&null!=n.submit.data("loading")&&Eadmin.button.loading(n.submit),null!=a.data("native"))return!0;n.formData=a.serialize(),n.callback=a.data("callback");function i(t){if(null!=n.callback)try{if(Method,!_.isFunction(Method[n.callback]))return console.log("指定的"+n.callback+"不是一个可被调用的函数"),0;Method[n.callback](t)}catch(t){console.log(t)}}return Eadmin.post({url:n.action,form:n.formData,then:function(t){var e=a.find(".editor");0<e.length&&(null!=(e=e.data("store"))&&store.remove(e)),Eadmin.button.reset(n.submit),i(t)},error:function(t){Eadmin.button.reset(n.submit),i(t)}}),!1}).on("keyup",".textarea-max",function(){var t=$(this),e=t.attr("maxlength"),a=t.val().length;e<a||t.next().html(a+" / "+e)})}},{key:"checkbox",value:function(t,e){var a={};1==e?(a={checked:!0,i_class:"ri-checkbox-line",class:"checkbox-checked"},2<arguments.length&&void 0!==arguments[2]&&arguments[2]?(a.i_class="ri-checkbox-indeterminate-line",t.addClass("checkbox-half")):t.removeClass("checkbox-half")):(a={checked:!1,i_class:"ri-checkbox-blank-line",class:"checkbox"},t.removeClass("checkbox-half")),t.prop("checked",a.checked).prev("i").attr("class",a.i_class).parent("label").attr("class",a.class)}},{key:"select",value:function(t){var e;0!=(e=t.find("select")).length&&e.each(function(){var t=$(this),e={txt:t.children("option:first").text(),default:t.find("option:first").val()};t.val(e.default).next().children("span").removeClass("selected").html(e.txt),t.next().next().find(".active").removeClass("active")})}},{key:"input",value:function(t){1<arguments.length&&void 0!==arguments[1]&&arguments[1]?t.removeClass("error-input"):t.addClass("error-input")}},{key:"textarea",value:function(t){1<arguments.length&&void 0!==arguments[1]&&arguments[1]?t.removeClass("error-input"):t.addClass("error-input")}}]),t}(),_createClass=function(){function n(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,a){return e&&n(t.prototype,e),a&&n(t,a),t}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Imageview=function(){function t(){_classCallCheck(this,t)}return _createClass(t,null,[{key:"run",value:function(){function i(t,e){t.css("transform","translate("+e.left+"px, "+e.top+"px) scale("+l+")")}var t=[1],l=t[0],s=t[1],n=t[2];body.on("click",".imageview",function(){l=1;var e,a,t=[$(this),{}],n=t[0],i=t[1];i.src=n.data("src"),0==body.find("#imageview").length?(body.append('<div id="imageview">\n\t\t\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t\t\t\t<li></li>\n\t\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t\t<div class="imageview-close">\n\t\t\t\t\t\t\t\t\t<i class="ri-close-line"></i>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="imageview-tips"></div>\n\t\t\t\t\t\t\t</div>'),s=$("#imageview")):s.show(),i.Image=new Image,i.Image.src=i.src,e=1,a=setInterval(function(){var t;0<i.Image.width||0<i.Image.height?(clearInterval(a),t=i.Image.width>=i.Image.height?"imgW":"imgH",t='<img \n\t\t\t\t\t\t\t\t\t\tondragstart="return false;" \n\t\t\t\t\t\t\t\t\t\tsrc="'+i.src+'" \n\t\t\t\t\t\t\t\t\t\tclass="'+t+'" \n\t\t\t\t\t\t\t\t\t\tstyle="transform:translate(0px, 0px) scale(1)">',s.find("li").html(t)):50<++e&&(clearInterval(a),Eadmin.popup.error({content:"大图加载失败"}))},40)}).on("click",".imageview-close",function(){s.find("li").empty(),s.hide()}).on("mousedown","#imageview img",function(t){var e=[$(this),{}],a=e[0],n=e[1];n.offset=a.offset(),n.x=t.clientX,n.y=t.clientY,n.transform=a.css("transform").replace(/[^0-9\-,]/g,"").split(","),n.t=parseInt(n.transform[5]),n.l=parseInt(n.transform[4]),$(document).on("mousemove",function(t){var e=n.t+(t.clientY-n.y),t=n.l+(t.clientX-n.x);i(a,{top:e,left:t})})}).on("mouseup","#imageview img",function(){$(document).off("mousemove")}).on("mousewheel DOMMouseScroll","#imageview img",function(t){clearTimeout(n);var e=[$(this),{e:t.originalEvent,tips:s.find(".imageview-tips")}],t=e[0],a=e[1];a.delta=a.e.detail&&(0<a.e.detail?-1:1)||a.e.wheelDelta&&(0<a.e.wheelDelta?-1:1),3<(l=(l+=-1==a.delta?.1:-.1)<1?1:l)&&(l=3),a.transform=t.css("transform").replace(/[^0-9\-,]/g,"").split(","),i(t,{top:a.transform[5],left:a.transform[4]}),a.tips.html((100*l).toFixed(0)+"%").show(),n=setTimeout(function(){a.tips.hide()},1e3)})}}]),t}(),_createClass=function(){function n(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,a){return e&&n(t.prototype,e),a&&n(t,a),t}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Message=function(){function t(){_classCallCheck(this,t)}return _createClass(t,null,[{key:"info",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this._createHtml({content:t.content,icon:"ri-error-warning-fill info",duration:t.duration})}},{key:"success",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this._createHtml({content:t.content,icon:"ri-checkbox-circle-fill success",duration:t.duration})}},{key:"error",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this._createHtml({content:t.content,icon:"ri-close-circle-fill error",duration:t.duration})}},{key:"_createHtml",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e={top:module.conf.message_top};e.top+=42*$(".message").length,e.html='<div class="message animated faster fadeInDown">\n\t\t\t<i class="'+t.icon+'"></i>'+t.content+"\n\t\t</div>",body.append(e.html),e.box=$(".message:last"),e.box.css({top:e.top,"margin-left":-e.box.outerWidth()/2}),e.duration=null!=t.duration?t.duration:module.conf.message_duration,setTimeout(function(){fadeOut(e.box,function(){e.box.nextAll(".message").animate({top:"-=42"},150),e.box.remove()})},1e3*e.duration)}}]),t}(),_createClass=function(){function n(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,a){return e&&n(t.prototype,e),a&&n(t,a),t}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Notice=function(){function t(){_classCallCheck(this,t)}return _createClass(t,null,[{key:"info",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this._createHtml({title:t.title,desc:t.desc,icon:null===t.icon?null:"ri-error-warning-fill info",href:t.href,duration:t.duration,callback:t.close})}},{key:"success",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this._createHtml({title:t.title,desc:t.desc,icon:"ri-checkbox-circle-fill success",href:t.href,duration:t.duration,callback:t.close})}},{key:"error",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this._createHtml({title:t.title,desc:t.desc,icon:"ri-close-circle-fill error",href:t.href,duration:t.duration,callback:t.close})}},{key:"_createHtml",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t={html:'<div class="notice animated faster fadeInRight">',ml:"",iconTop:""},a=function(t){t.addClass("fadeOutRight").on("animationend",function(){t.remove(),null!=e.callback&&_.isFunction(e.callback)&&e.callback()})};if(null!=e.desc&&""!=e.desc||(t.iconTop=' style="top:12px;"'),null!=e.icon&&(t.html+='<i class="title-icon '+e.icon+'"'+t.iconTop+"></i>",t.ml=' style="margin-left:32px"'),t.html+='<i class="ri-close-line close"></i>\n\t\t\t<div class="box"'+t.ml+'>\n\t\t\t\t<div class="notice-title">'+e.title+"</div>",null!=e.desc&&(t.html+='<div class="desc">'+e.desc+"</div>"),null!=e.href&&_.isArray(e.href))for(var n in e.href){var i=null!=e.href[n].native?' data-native="1"':"",l=null!=e.href[n].target?' target="'+e.href[n].target+'"':"";t.html+='<div class="href">\n\t\t\t\t\t<a href="'+e.href[n].href+'"'+i+l+">"+e.href[n].txt+"</a>\n\t\t\t\t</div>"}t.html+="</div></div>",$("#notice").append(t.html);var s=$(".notice:last"),r=null!=e.duration?e.duration:module.conf.notice_duration;s.children(".close").on("click",function(){a(s)}),0!=r&&setTimeout(function(){a(s)},1e3*r)}}]),t}(),_createClass=function(){function n(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,a){return e&&n(t.prototype,e),a&&n(t,a),t}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Page=function(){function a(t){var e;_classCallCheck(this,a),this.window=null!=Mount.window?"#"+Mount.window:null,this.param=t,this.get={},this.query="",(this.searchBoxCache=null)!=t.search&&(this.searchBox=null!=this.window?this.window+" "+t.search.boxid:t.search.boxid,this.searchBoxCache=$(this.searchBox)),(this.pageBoxCache=null)!=t.config.page&&(this.pageBox=null!=this.window?this.window+" "+t.config.page.boxid:t.config.page.boxid,this.pageBoxCache=$(this.pageBox),this.storeKey=md5(Eadmin.currentHref),this.page=1,null!=(e=store(this.storeKey+"_page"))&&(this.page=+e),this.pageCount=null,this.size=t.config.page.size,null!=(t=store(this.storeKey+"_size"))&&(this.size=+t),this.get[this.param.config.page.page_field]=this.page,this.get[this.param.config.page.size_field]=this.size),this.tmpBox=scope('[data-template="'+this.param.config.tmp+'"]'),this.init=!1,this.run()}return _createClass(a,[{key:"run",value:function(){this._create(),this._event()}},{key:"_create",value:function(){var t=this,n=this;(function(){var a;null!=t.param.search&&(a='<div class="table-search"><form><div class="block-box table-search-box">',_.each(t.param.search.field,function(t,e){switch(a+='<div class="col-3"><div class="form-group">',t.type){case"input":a+='<div class="input-group">\n\t\t\t\t\t\t\t\t\t\t<span class="prepend">'+t.name+'</span>\n\t\t\t\t\t\t\t\t\t\t<input name="'+e+'" type="text" placeholder="请输入'+t.name+'">\n\t\t\t\t\t\t\t\t\t</div>';break;case"datepicker":a+='<div class="input-group">\n\t\t\t\t\t\t\t\t\t\t<span class="prepend">'+t.name+'</span>\n\t\t\t\t\t\t\t\t\t\t<input \n\t\t\t\t\t\t\t\t\t\t\tid="table-datepicker-'+e+'" \n\t\t\t\t\t\t\t\t\t\t\tclass="table-datepicker"\n\t\t\t\t\t\t\t\t\t\t\tname="'+e+'" \n\t\t\t\t\t\t\t\t\t\t\ttype="text" \n\t\t\t\t\t\t\t\t\t\t\tplaceholder="请选择'+t.name+'">\n\t\t\t\t\t\t\t\t\t</div>';break;case"citypicker":a+='<div class="input-group">\n\t\t\t\t\t\t\t\t\t\t<span class="prepend">'+t.name+'</span>\n\t\t\t\t\t\t\t\t\t\t<input \n\t\t\t\t\t\t\t\t\t\t\tid="table-citypicker-'+e+'" \n\t\t\t\t\t\t\t\t\t\t\tclass="table-citypicker"\n\t\t\t\t\t\t\t\t\t\t\tname="'+e+'" \n\t\t\t\t\t\t\t\t\t\t\ttype="text" \n\t\t\t\t\t\t\t\t\t\t\tplaceholder="请选择'+t.name+'">\n\t\t\t\t\t\t\t\t\t</div>';break;case"select":a+='<select name="'+e+'" data-width="100%">\n\t\t\t\t\t\t\t\t\t\t<option value="">请选择'+t.name+"</option>",_.each(t.option,function(t){a+='<option value="'+t.val+'">'+t.key+"</option>"}),a+="</select>"}a+="</div></div>"}),a+='<div class="col-3">\n\t\t\t\t\t\t\t<button class="search-do middle hl">\n\t\t\t\t\t\t\t\t<i class="ri-search-line"></i>搜索\n\t\t\t\t\t\t\t</button><button class="search-refresh middle">\n\t\t\t\t\t\t\t\t<i class="ri-refresh-line"></i>重置\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div></form></div>',t.searchBoxCache.prepend(a),t.searchBoxCache.find(".table-datepicker").each(function(){var t=$(this),e=t.attr("name"),a={};null!=n.param.search.field[e].param&&(a=n.param.search.field[e].param),Eadmin.datepicker("#"+t.attr("id"),a)}),t.searchBoxCache.find(".table-citypicker").each(function(){var t=$(this),e=t.attr("name"),a={};null!=n.param.search.field[e].param&&(a=n.param.search.field[e].param),Eadmin.citypicker("#"+t.attr("id"),a)}))})(),this._loadData(!1)}},{key:"_event",value:function(){var t=[".search-do",".search-refresh",".table-page select",".table-page .num-page:not(.current)",".table-page .prev-page",".table-page .next-page",".table-page button"],e=this,a=function(t){Eadmin.message.error({content:t}),e.pageBox.find("input").val("")};null!=e.param.search&&e.searchBoxCache.on("click",t[0],function(){e.page=1,e.get[e.param.config.page.page_field]=e.page;var t=e.searchBoxCache.find("form").serialize();t!=e.query&&(e.get._search=1,e.query=t);t=_.split(t,"&");return _.each(t,function(t){t=_.split(t,"=");e.get[t[0]]=decodeURIComponent(t[1])}),e._loadData(!0),!1}).on("click",t[1],function(){return e.searchBoxCache.find("input").val(""),Form.select(e.searchBoxCache),!1}),null!=e.param.config.page&&e.pageBoxCache.on("change",t[2],function(){e.page=1,e.size=+$(this).val(),store(e.storeKey+"_page",e.page.toString()),store(e.storeKey+"_size",e.size.toString()),e.get[e.param.config.page.page_field]=e.page,e.get[e.param.config.page.size_field]=e.size,e._loadData(!0)}).on("click",t[3],function(){e.page=+$(this).html(),store(e.storeKey+"_page",e.page.toString()),e.get[e.param.config.page.page_field]=e.page,e._loadData(!0)}).on("click",t[4],function(){1!=e.page&&(--e.page,store(e.storeKey+"_page",e.page.toString()),e.get[e.param.config.page.page_field]=e.page,e._loadData(!0))}).on("click",t[5],function(){e.page!=e.pageCount&&(e.page+=1,store(e.storeKey+"_page",e.page.toString()),e.get[e.param.config.page.page_field]=e.page,e._loadData(!0))}).on("click",t[6],function(){var t=e.pageBoxCache.find("input").val();""!=t?t<1?a("跳转的页数不能小于1"):t>e.pageCount?a("跳转的页数已经超出了最大页数"):t!=e.page?(store(e.storeKey+"_page",t),e.page=+t,e.get[e.param.config.page.page_field]=e.page,e._loadData(!0)):a("已经在待跳转的页面了"):a("跳转的页数不能为空")})}},{key:"_page",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(this.param.config.page)if(_.has(t,"count")){this.init||this.pageBoxCache.data("size",this.size);var a={count:this.pageBoxCache.find("em:first"),page:this.pageBoxCache.find("em").eq(1),pageCount:this.pageBoxCache.find("em").eq(2)};t.count==+a.count.html()&&this.size==this.pageBoxCache.data("size")||(t.count<this.size?this.pageCount=1:t.count%this.size==0?this.pageCount=t.count/this.size:this.pageCount=parseInt(t.count/this.size)+1,a.count.html(t.count),a.pageCount.html(this.pageCount),this.size!=this.pageBoxCache.data("size")&&this.pageBoxCache.data("size",this.size)),a.page.html(this.page);t=10;_.has(this.param.config.page,"num")&&10<(t=(t=this.param.config.page.num)<3?3:t)&&(t=10);var n="",a=this.page,i=t+((a-=_.floor(t/2))<1?(a=1,0):this.page-_.floor(t/2)-1);(i=i>this.pageCount?this.pageCount:i)-a<t-1&&(a-=t-(i-a)-1);for(var l=a=a<1?1:a;l<=i;l++)n+='<span class="num-page'+(l==this.page?" current":"")+'" data-page="'+l+'">'+l+"</span>";this.pageBoxCache.find(".num-page").remove(),this.pageBoxCache.find(".prev-page").after(n),this.init&&e&&module.conf.page_show_message&&Eadmin.message.success({content:"当前第 "+this.page+" 页，共 "+this.pageCount+" 页"})}else console.log("数据源中未包含数据总条数count字段，创建分页失败")}},{key:"_loadData",value:function(){var n=this,i=0<arguments.length&&void 0!==arguments[0]&&arguments[0];this.tmpBox.html('<div class="table-shade" style="display:flex;">\n\t\t\t\t\t\t<i class="ri-loader-4-line rotate"></i>数据加载中，请稍候...\n\t\t\t\t\t</div>'),this.searchBoxCache.hide(),this.pageBoxCache.hide(),i&&(null!=this.window?_.startsWith(this.window,"#tab")||($(this.window+" .body")[0].scrollTop=0):box[0].scrollTop=0),Eadmin.get({url:this.param.config.data,param:this.get,then:function(t){var e,a;null!=t.count||null==n.param.config.page?null!=t.list?(Eadmin.template(n.param.config.tmp,t,function(){col(n.tmpBox),defaultImg(n.tmpBox),_.isFunction(n.param.callback)&&n.param.callback(t)}),n.searchBoxCache.show(),n.pageBoxCache.show(),e=n.searchBoxCache.children(".empty"),0<t.count?(n.param.config.page&&(a='<div class="table-page">\n\t\t\t\t\t\t\t<span class="info">\n\t\t\t\t\t\t\t\t共<em></em>条，每页\n\t\t\t\t\t\t\t\t<select name="pagesize" data-width="70">\n\t\t\t\t\t\t\t\t\t<option value="0">请选择</option>\n\t\t\t\t\t\t\t\t\t<option value="'+(a=n.param.config.page.size)+'"'+(n.size==a?" selected":"")+">"+a+'</option>\n\t\t\t\t\t\t\t\t\t<option value="'+2*a+'"'+(n.size==2*a?" selected":"")+">"+2*a+'</option>\n\t\t\t\t\t\t\t\t\t<option value="'+3*a+'"'+(n.size==3*a?" selected":"")+">"+3*a+'</option>\n\t\t\t\t\t\t\t\t\t<option value="'+4*a+'"'+(n.size==4*a?" selected":"")+">"+4*a+"</option>\n\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t条，\n\t\t\t\t\t\t\t\t当前 <em>"+n.page+'</em>/<em>-</em> 页\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t<span class="prev-page"><i class="ri-arrow-left-s-line"></i></span>\n\t\t\t\t\t\t\t<span class="next-page"><i class="ri-arrow-right-s-line"></i></span>\n\t\t\t\t\t\t\t<span class="jump">\n\t\t\t\t\t\t\t\t跳转到第\n\t\t\t\t\t\t\t\t<input name="page" type="text" placeholder="页数">\n\t\t\t\t\t\t\t\t页\n\t\t\t\t\t\t\t\t<button class="hl small">确定</button>\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>',n.pageBoxCache.html(a),Eadmin.form(n.pageBoxCache)),n._page(t,i),0<e.length&&e.hide()):0==e.length?n.searchBoxCache.append('<div class="empty">该列表暂无更多数据~</div>'):e.show(),n.init=!0,n.get._search=0):console.log("数据源中没有包含list字段"):console.log("返回的数据源中没有 count 字段，无法使用分页")}})}}]),a}(),_createClass=function(){function n(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,a){return e&&n(t.prototype,e),a&&n(t,a),t}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Popup=function(){function t(){_classCallCheck(this,t),this.Timer=null}return _createClass(t,null,[{key:"alert",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this._createHtml({title:"消息提示",icon:"ri-error-warning-fill alert",txt:t.content,btn:'<button id="close" class="hl middle">确定 (<em>3</em>)</button>'});var e=$(".popup");fadeIn(e),this._countdown(e,t)}},{key:"success",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this._createHtml({title:"操作成功",icon:"ri-checkbox-circle-fill success",txt:t.content,btn:'<button id="close" class="hl middle">确定 (<em>3</em>)</button>'});var e=$(".popup");fadeIn(e),this._countdown(e,t)}},{key:"error",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this._createHtml({title:"操作失败",icon:"ri-close-circle-fill error",txt:t.content,btn:'<button id="close" class="hl middle">确定 (<em>3</em>)</button>'});var e=$(".popup");fadeIn(e),this._countdown(e,t)}},{key:"confirm",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this._createHtml({title:"操作确认",icon:"ri-question-fill confirm",txt:t.content,btn:'<button id="sure" class="hl middle" style="margin-right:5px;">确定</button>\n\t\t\t\t\t<button id="close" class="middle">取消</button>'}),Eadmin.mask();var e=$(".popup");fadeIn(e),e.find("#close").on("click",function(){Eadmin.maskHide(),fadeOut(e),_.isFunction(t.cancel)&&t.cancel()}),e.find("#sure").on("click",function(){$(this).html("执行中...").attr("disabled",!0),_.isFunction(t.submit)&&t.submit()})}},{key:"_createHtml",value:function(){var t,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};1==$(".popup").length?((t=$(".popup")).is(":visible")&&t.hide(),(t={title:t.children(".title"),icon:t.children("i"),txt:t.children(".txt"),btn:t.children(".btn")}).title.html(e.title),t.icon.attr("class",e.icon),t.txt.html(e.txt),t.btn.html(e.btn)):(a='<div class="popup animated faster dn">\n\t\t\t\t<span class="title">'+e.title+'</span>\n\t\t\t\t<i class="'+e.icon+'"></i>\n\t\t\t\t<span class="txt">'+e.txt+'</span>\n\t\t\t\t<div class="btn">'+e.btn+"</div>\n\t\t\t</div>",$("body").append(a));var a=$(".window:visible").length;0<a&&$(".popup").css("z-index",9999+a)}},{key:"_countdown",value:function(t,e){var a=this,n=function(){Eadmin.maskHide(),fadeOut(t),clearInterval(a.Timer),a.Timer=null,_.isFunction(e.submit)&&e.submit(),!0===e.refresh&&Eadmin.refresh()};Eadmin.mask();var i=3;this.Timer=setInterval(function(){0!=--i?t.find("em").html(i):n()},1e3),t.find("#close").on("click",function(){n()})}}]),t}(),_createClass=function(){function n(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,a){return e&&n(t.prototype,e),a&&n(t,a),t}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Progress=function(){function t(){_classCallCheck(this,t)}return _createClass(t,null,[{key:"run",value:function(t){t=(t=null==t?body:$(t)).find("[data-percent]");0!=t.length&&t.each(function(){var t=[$(this),{}],e=t[0],a=t[1];a.html='<div class="bg"></div>',a.percent=e.data("percent"),a.width=e.data("percent-width"),null!=a.width?e.width(a.width):a.width=e.width();var n=_.floor(a.width/100*a.percent),t=e.data("percent-color");a.color=null==t?"":" linear-"+t,a.html+='<div class="percent'+a.color+'" style="width:'+n+'px;"></div>',null!=e.data("show-percent")&&(a.html+='<div class="point">'+a.percent+"%</div>"),e.addClass("progress").html(a.html)})}}]),t}(),_createClass=function(){function n(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,a){return e&&n(t.prototype,e),a&&n(t,a),t}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Rate=function(){function a(t,e){_classCallCheck(this,a),this.dom=t,this.domCache=scope(t),0!=this.domCache.length?(this.domCache.addClass("rate"),this.param=$.extend({default:0,disabled:!1,num:5,change:null,bind:null},e),0<this.param.default&&this.domCache.data("level",this.param.default),this.run()):console.log("没有找到"+t+"，创建评分失败")}return _createClass(a,[{key:"run",value:function(){this._create(),this._event()}},{key:"_create",value:function(){for(var t="",e=1;e<=this.param.num;e++){var a=this.param.default>=e?" full":"";t+='<div class="animated faster star ri-star-line\n\t\t\t\t\t\t'+(this.param.disabled?" disabled":"")+"\n\t\t\t\t\t\t"+a+'" \n\t\t\t\t\t\tdata-level="'+e+'">\n\t\t\t\t\t</div>'}this.domCache.html(t),null!=this.param.bind&&this.domCache.after('<input name="'+this.param.bind+'" type="hidden" value="'+this.param.default+'">')}},{key:"_event",value:function(){var a=0,n=0,e=this;e.domCache.on("mouseover",".star",function(){var t=$(this),e={parent:t.parent()};(1==(n=t.data("level"))?t:e.parent.children(".star:lt("+n+")")).addClass("full"),n-a<0&&e.parent.children(".star:gt("+(n-1)+")").removeClass("full")}).on("mouseout",".star",function(){a=n}).on("click",".star:not(.disabled)",function(){var t=$(this);t.removeClass("pulse").addClass("pulse").one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){t.removeClass("pulse")}),t.parent().data("level",n),_.isFunction(e.param.change)&&e.param.change(n),null!=e.param.bind&&e.domCache.next("input").val(n)}).on("mouseleave",function(){var t=$(this),e=t.data("level");null!=e?(t.children(".star").removeClass("full"),t.children(".star:lt("+e+")").addClass("full")):t.children(".star").removeClass("full")})}}]),a}(),_createClass=function(){function n(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,a){return e&&n(t.prototype,e),a&&n(t,a),t}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Slider=function(){function n(t){var e=this,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,n),this.dom=t,this.domCache=scope(this.dom),0!=this.domCache.length?setTimeout(function(){e.width=e.domCache.width(),e.btnWidth=16,e.maxLeft=e.width-e.btnWidth,e.offsetX=e.domCache.offset().left,e.stepWidth=0;e.param=$.extend({value:0,disabled:!1,step:0,min:0,max:100,tips:"",change:null,bind:null},a),e.run()},50):console.log("没有"+this.dom+"元素，滑块不再创建")}return _createClass(n,[{key:"run",value:function(){this._create(),this.param.disabled||this._event()}},{key:"_create",value:function(){function t(t){t.hasClass("slider")||t.addClass("slider"),l.param.disabled&&t.addClass("slider-disabled");var e="",a=void 0;if(0<l.param.step){l.stepWidth=_.round(l.width/l.param.step);for(var n=1;n<l.param.step;n++)e+='<div class="step" style="left: '+l.stepWidth*n+'px;"></div>';a=l.param.value/l.param.step*l.stepWidth,(a=(a-=8)<0?0:a)>l.maxLeft&&(a=l.maxLeft)}else a=_.floor(l.maxLeft/(l.param.max-l.param.min)*l.param.value);var i=l.param.value;0==i&&(i=l.param.min),""!=l.param.tips&&(i=_.replace(l.param.tips,"[val]",i)),e+='<div class="slider-btn'+(l.param.disabled?" tips-disabled":"")+'" data-tips="'+i+'"\n\t\t\t\t\t\tdata-tips-center style="left:'+a+'px;">\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="slider-bar" style="width:'+(a+l.btnWidth)+'px;"></div>',null!=l.param.bind&&(e+='<input type="hidden" name="'+l.param.bind+'" value="'+l.param.value+'">'),t.html(e)}var l=this;1==this.domCache.length?t(this.domCache):this.domCache.each(function(){t($(this))})}},{key:"_event",value:function(){var l=this,s=0;l.domCache.on("mouseenter",".slider-btn",function(){$(this).data("active",1)}).on("mouseleave",".slider-btn",function(){$(this).data("active",0)}).on("mousedown",".slider-btn",function(t){var e=$(this),a={clientX:null,clientXClone:t.clientX,allow:!0,timer:null,val:0};a.left=parseInt(e.css("left")),a.bar=e.next(".slider-bar"),e.addClass("tips-disabled"),selectEnabled&&userselect(0),$(document).bind("mousemove",function(t){if(a.clientX=t.clientX-a.clientXClone,(s=a.left+a.clientX)<0||s>l.maxLeft){if(!a.allow)return;s=l._checkLeft(s),a.allow=!1}else a.allow=!0;0<l.param.step?(s==l.maxLeft?(s=l.maxLeft,a.val=l.param.max):(t=l._stepVal(s),a.val=t.val,s=t.left),e.css("left",s),a.bar.width(s+l.btnWidth)):(e.css("left",s),a.bar.width(s+l.btnWidth),a.val=l._val(s),a.val+=l.param.min),clearTimeout(a.timer),l._tips(a.val,e),Tips.reset(e,{offset:"middle"}),a.timer=setTimeout(function(){null!=l.param.change&&_.isFunction(l.param.change)&&l.param.change(a.val),null!=l.param.bind&&e.next().next().val(a.val)},400)}).bind("mouseup",function(){e.removeClass("tips-disabled"),0==e.data("active")&&Tips.destory(e),$(this).unbind("mousemove").unbind("mouseup")})}).on("mouseup",".slider-btn",function(){selectEnabled&&userselect(1),$(this).parent().data("btn",!0)}).on("click",function(t){var e,a,n=$(this),i={val:0};1!=n.data("btn")?(s=_.floor(t.clientX-l.offsetX),s-=l.btnWidth/2,s=l._checkLeft(s),e=n.children(".slider-btn"),a=n.children(".slider-bar"),0==l.param.step?i.val=l._val(s):s!=l.maxLeft?(t=l._stepVal(s),i.val=t.val,s=t.left):i.val=l.param.max,e.css("left",s),a.width(s+l.btnWidth),l._tips(i.val,e),null!=l.param.change&&_.isFunction(l.param.change)&&l.param.change(i.val)):n.data("btn",!1)})}},{key:"_tips",value:function(t,e){""!=this.param.tips&&(t=_.replace(this.param.tips,"[val]",t)),e.data("tips",t)}},{key:"_checkLeft",value:function(t){return t=(t=t<0?0:t)>this.maxLeft?this.maxLeft:t}},{key:"_val",value:function(t){return _.floor((this.param.max-this.param.min)/this.maxLeft*t)}},{key:"_stepVal",value:function(t){var e=0,t=parseInt((t+this.btnWidth/2)/this.stepWidth);return 0<(e=t*this.stepWidth)&&(e-=this.btnWidth/2),{val:t*this.param.step,left:e}}}]),n}(),_createClass=function(){function n(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,a){return e&&n(t.prototype,e),a&&n(t,a),t}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Tab=function(){function a(t,e){_classCallCheck(this,a),this.dom=scope(t),this.panel=this.dom.children(".tab-panel"),this.active=null,0!=this.panel.length?(this.param=e,this.run()):console.log("容器内没有找到.tab-panel元素，构建选项卡失败")}return _createClass(a,[{key:"run",value:function(){this._create(),this._init(),this._event()}},{key:"_create",value:function(){var a,n=this;0!=this.param.length?(a='<div class="tab">',_.each(this.param,function(t,e){a+="<span",!0===t.active&&(a+=' class="active"',n.active=e),a+=">",null!=t.num&&0<+t.num&&(a+='<div class="mark">'+t.num+"</div>"),null!=t.icon&&(a+='<i class="'+t.icon+'"></i>'),a+=t.name+"</span>"}),a+="</div>",this.dom.prepend(a),this.tab=this.dom.children(".tab")):console.log("请至少指定1个选项卡")}},{key:"_init",value:function(){null==this.active&&(this.active=0),this.panel.eq(this.active).show(),this._load()}},{key:"_event",value:function(){var a=this;this.tab.on("click","span:not(.active)",function(){var t=[$(this),{}],e=t[0],t=t[1];t.index=e.index(),addClassExc(e,"active"),a.active=t.index,a.panel.hide().eq(t.index).show(),a._load()})}},{key:"_load",value:function(){var e,t,a=this.param[this.active].load;null!=a&&null==this.param[this.active].loaded&&(this.param[this.active].loaded=!0,e=this.panel.eq(this.active),t="tab-window-"+createId(),e.attr("id",t),Mount.window=t,e.html('<div class="panel-loading">\n\t\t\t\t\t\t<i class="ri-loader-4-line rotate"></i>页面加载中，请稍候...\n\t\t\t\t\t</div>'),Eadmin.currentHref=a,e.load(a,function(){defaultImg(e),block(e),Eadmin.form(e),Button.run(e),Tag.run(e);var t=body.find(".iscroll");0<t.length&&t.each(function(){return!!$(this).hasClass("ps")||void Eadmin.scroll($(this)[0])}),Progress.run(e)}))}}]),a}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_createClass=function(){function n(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,a){return e&&n(t.prototype,e),a&&n(t,a),t}}();function _toConsumableArray(t){if(Array.isArray(t)){for(var e=0,a=Array(t.length);e<t.length;e++)a[e]=t[e];return a}return Array.from(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Table=function(){function n(t,e){var a;_classCallCheck(this,n),this.domCache=scope(t),0!=this.domCache.length?(this.window=null!=Mount.window?"#"+Mount.window:null,this.dom=null!=this.window?this.window+" "+t:t,this.storeKey=md5(Eadmin.currentHref),this.page=1,null!=(a=store(this.storeKey+"_page"))&&(this.page=+a),this.size=10,this.pageCount=null,this.searchBox=null,this.toolsBox=null,this.pageBox=null,this.table=null,this.shade=null,this.init=!1,this.btns=[],this.columnOpen=[],this.checked=0,this.get={},this.query="",this.width=+this.domCache.width(),this.scroll=null,this.columnId="column-config-"+createId(),this.column=[],this.columnConfig=store(this.storeKey+"_column"),this.columnConfig=null==this.columnConfig?{}:JSON.parse(this.columnConfig),this.exportExcel="exportExcel_"+createId(),this.excelColumn={},this.color=["#0084ff","#FF1844","#76FF02","#FFFF01","#FF7C00","#F52394","#00B2D4","#800080","#593110"],this.param=$.extend(!0,{config:{checkbox:!1,column_config:!1,export_excel:!1,fixed:{first:!1,last:!1},page:{size:10,num:5,page_field:"page",size_field:"size"},data:""},button:[],column:[],search:{},callback:null},e),_.isBoolean(this.param.config.page)||(null!=(e=store(this.storeKey+"_size"))&&(this.param.config.page.size=+e),this.size=this.param.config.page.size,this.get[this.param.config.page.page_field]=this.page,this.get[this.param.config.page.size_field]=this.size),this.domCache.addClass("table").hide().before('<div class="table-shade">\n\t\t\t\t\t\t<i class="ri-loader-4-line rotate"></i>数据加载中，请稍候...\n\t\t\t\t\t</div>'),this.shade=this.domCache.prev(".table-shade"),this.haveFixed=this.param.config.fixed.first,this.run()):console.log("没有找到表格容器"+t+"，创建失败")}return _createClass(n,[{key:"run",value:function(){0!=this.param.column.length?(""==this.param.config.data&&console.log("没有指定数据源地址，无法创建表格实体"),this._create(),this._event(),this._resize()):console.log("至少为表格添加一列才可以创建表格")}},{key:"refresh",value:function(){this._loadData(!1)}},{key:"_create",value:function(){var s=this,i="",r=[],l={order:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"";return!0===t?'<span class="order">\n\t\t\t\t\t\t\t\t<i class="ri-arrow-up-s-line asc" data-order="'+e+',asc"></i>\n\t\t\t\t\t\t\t\t<i class="ri-arrow-down-s-line desc" data-order="'+e+',desc"></i>\n\t\t\t\t\t\t\t</span>':""},head:function(){i+="<thead><tr>",i+=s._checkbox(),_.each(s.param.column,function(a,t){if(!0===a.search&&r.push(t),!1===a.column)return!0;var e=!0,n=0==t||t+1==s.param.column.length;null!=s.columnConfig[a.field]&&(e=s.columnConfig[a.field]),i+='<td class="td-'+t+(e?"":" dn")+'">\n\t\t\t\t\t\t\t\t'+a.name+l.order(a.order,a.field)+"\n\t\t\t\t\t\t\t</td>",s.column.push({name:a.name,disabled:n,checked:e,click:function(t){var e=s.table.t.find(".td-"+t._index);t._checked?e.show():e.hide(),s.columnConfig[a.field]=t._checked,store(s.storeKey+"_column",JSON.stringify(s.columnConfig))}}),null!=a.field&&(s.excelColumn[a.field]=a.name)}),i+="</tr></thead>"},search:function(){var i,l;0!=r.length&&(i='<div class="table-search dn">\n\t\t\t\t\t\t<form>\n\t\t\t\t\t\t\t<div class="block-box table-search-box">',l=[],_.each(r,function(t,e){i+='<div class="col-3"><div class="form-group">';var a=s.param.column[t];if(null==s.param.search[a.field])i+='<div class="input-group">\n\t\t\t\t\t\t\t\t\t<span class="prepend">'+a.name+'</span>\n\t\t\t\t\t\t\t\t\t<input name="'+a.field+'" type="text" placeholder="请输入'+a.name+'">\n\t\t\t\t\t\t\t\t</div>';else{var n=s.param.search[a.field];switch(n.type){case"select":i+='<select name="'+a.field+'" data-width="100%">\n\t\t\t\t\t\t\t\t\t\t\t<option value="">\n\t\t\t\t\t\t\t\t\t\t\t\t请选择'+a.name+"\n\t\t\t\t\t\t\t\t\t\t\t</option>",_.each(n.option,function(t){i+='<option value="'+t.val+'">\n\t\t\t\t\t\t\t\t\t\t\t\t'+t.key+"\n\t\t\t\t\t\t\t\t\t\t\t</option>"}),i+="</select>";break;case"datepicker":i+='<div class="input-group">\n\t\t\t\t\t\t\t\t\t\t\t<span class="prepend">'+a.name+'</span>\n\t\t\t\t\t\t\t\t\t\t\t<input \n\t\t\t\t\t\t\t\t\t\t\t\tid="table-datepicker-'+e+'" \n\t\t\t\t\t\t\t\t\t\t\t\tclass="table-datepicker"\n\t\t\t\t\t\t\t\t\t\t\t\tname="'+a.field+'" \n\t\t\t\t\t\t\t\t\t\t\t\tdata-key="'+e+'"\n\t\t\t\t\t\t\t\t\t\t\t\ttype="text" \n\t\t\t\t\t\t\t\t\t\t\t\tplaceholder="请选择'+a.name+'">\n\t\t\t\t\t\t\t\t\t\t</div>',l[e]=n.param;break;case"citypicker":i+='<div class="input-group">\n\t\t\t\t\t\t\t\t\t\t\t<span class="prepend">'+a.name+'</span>\n\t\t\t\t\t\t\t\t\t\t\t<input \n\t\t\t\t\t\t\t\t\t\t\t\tid="table-citypicker-'+e+'" \n\t\t\t\t\t\t\t\t\t\t\t\tclass="table-citypicker"\n\t\t\t\t\t\t\t\t\t\t\t\tname="'+a.field+'" \n\t\t\t\t\t\t\t\t\t\t\t\tdata-key="'+e+'"\n\t\t\t\t\t\t\t\t\t\t\t\ttype="text" \n\t\t\t\t\t\t\t\t\t\t\t\tplaceholder="请选择'+a.name+'">\n\t\t\t\t\t\t\t\t\t\t</div>',l[e]=n.param}}i+="</div></div>"}),i+='<div class="col-3">\n\t\t\t\t\t\t\t<button class="search-do hl middle">\n\t\t\t\t\t\t\t\t<i class="ri-search-line"></i>搜索\n\t\t\t\t\t\t\t</button><button class="search-refresh middle">\n\t\t\t\t\t\t\t\t<i class="ri-refresh-line"></i>重置\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div></form></div>',s.domCache.before(i),s.searchBox=s.domCache.prev(".table-search"),s.searchBox.find(".table-datepicker").each(function(){var t=$(this);Eadmin.datepicker("#"+t.attr("id"),l[t.data("key")])}),s.searchBox.find(".table-citypicker").each(function(){var t=$(this);Eadmin.citypicker("#"+t.attr("id"),l[t.data("key")])}))},tools:function(){var a;(0!=s.param.button.length||s.param.config.column_config||s.param.config.export_excel)&&(a='<div class="table-tools dn">',_.each(s.param.button,function(t,e){a+='<button id="table-btn-'+e+'" ',a+=0==e?'class="hl middle">':'class="middle">',null!=t.icon&&(a+='<i class="'+t.icon+'"></i>'),a+=t.name+"</button>"}),s.param.config.export_excel&&(a+='<button \n\t\t\t\t\t\t\t\tid="export-excel" \n\t\t\t\t\t\t\t\tclass="middle" \n\t\t\t\t\t\t\t\tdata-loading="数据导出中..." \n\t\t\t\t\t\t\t\tdata-do="'+s.exportExcel+'">\n\t\t\t\t\t\t\t\t<i class="ri-download-2-line"></i>导出excel\n\t\t\t\t\t\t\t</button>'),s.param.config.column_config&&(a+='<button id="'+s.columnId+'" class="middle mr0 fr">\n\t\t\t\t\t\t\t\t<i class="ri-settings-2-line"></i>表头\n\t\t\t\t\t\t\t</button>'),a+="</div>",s.domCache.before(a),s.toolsBox=s.domCache.prev(".table-tools"))},page:function(){var t;_.isBoolean(s.param.config.page)||(t='<div class="table-page dn">\n\t\t\t\t\t\t\t\t<span class="info">\n\t\t\t\t\t\t\t\t\t共<em></em>条，每页\n\t\t\t\t\t\t\t\t\t<select name="pagesize" data-width="70">\n\t\t\t\t\t\t\t\t\t\t<option value="0">请选择</option>\n\t\t\t\t\t\t\t\t\t\t<option value="10"'+(10==s.size?" selected":"")+'>10</option>\n\t\t\t\t\t\t\t\t\t\t<option value="30"'+(30==s.size?" selected":"")+'>30</option>\n\t\t\t\t\t\t\t\t\t\t<option value="50"'+(50==s.size?" selected":"")+'>50</option>\n\t\t\t\t\t\t\t\t\t\t<option value="100"'+(100==s.size?" selected":"")+">100</option>\n\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t条，当前 <em>"+s.page+'</em>/<em>-</em> 页\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t<span class="prev-page"><i class="ri-arrow-left-s-line"></i></span>\n\t\t\t\t\t\t\t\t<span class="next-page"><i class="ri-arrow-right-s-line"></i></span>\n\t\t\t\t\t\t\t\t<span class="jump">\n\t\t\t\t\t\t\t\t\t跳转到第 <input name="page" type="text" placeholder="页数"> 页\n\t\t\t\t\t\t\t\t\t<button class="hl small">确定</button>\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>',s.domCache.after(t),s.pageBox=s.domCache.next(".table-page"))},fixed:function(){var t,e="";s.param.config.fixed.first&&(e+='<div class="fixed-left"><table><thead><tr>',e+=s._checkbox(null,!0),e+="<td>"+(t=_.head(s.param.column)).name+l.order(t.order,t.field)+"</td></tr></thead>",e+="<tbody></tbody></table></div>"),s.param.config.fixed.last&&(e+='<div class="fixed-right"><table><thead><tr>',e+="<td>"+(t=_.last(s.param.column)).name+l.order(t.order,t.field)+"</td></tr></thead>",e+="<tbody></tbody></table></div>"),s.domCache.append(e)},body:function(){l.head(),l.search(),l.tools(),l.page(),i+="<tbody></tbody></table></div>",s.domCache.html(i),l.fixed(),0!=s.param.button.length||s.param.config.column_config||s.param.config.export_excel||s.domCache.find("thead > tr").addClass("head-border-top"),s.table={head:s.domCache.find("thead"),body:s.domCache.find("tbody"),lbox:s.domCache.find(".fixed-left"),rbox:s.domCache.find(".fixed-right"),box:s.domCache.find(".table-box")},s.table.t=s.table.box.children("table"),s.table.c=s.table.t.children("tbody"),s.table.l=s.table.lbox.find("tbody"),s.table.r=s.table.rbox.find("tbody")}},i='<div class="table-box" style="width:'+this.width+'px;"><table style="width:'+this.width+'px;">';l.body(),this._loadData()}},{key:"_event",value:function(){var t,a,n,i=this,e=["thead .checkall","tbody .checkall","tbody tr",".search-do",".search-refresh",".table-page select",".table-page .num-page:not(.current)",".table-page .prev-page",".table-page .next-page",".table-page button",".table-tools button",".order i:not(.active)",'[data-model="switch"]',".column-btn",".column-window"],l=function(t){Eadmin.message.error({content:t}),r.pageBox.find("input").val("")},s=[this,this.domCache.parent()],r=s[0],s=s[1];r.param.config.checkbox&&s.on("click",e[0],function(){var t=[$(this),{}],e=t[0],t=t[1];t.isCheck=e.is(":checked")?1:0,r.checked=1==t.isCheck?r.size:0,t.checkbox=(r.haveFixed?r.table.l:r.table.t).find(".checkall"),Form.checkbox(t.checkbox,t.isCheck)}).on("click",e[1],function(){var t=[$(this),0],e=t[0];r.checked+=e.is(":checked")?1:-1,t=r.checked==r.size?1:0,Form.checkbox(r.table.head.find(".checkall"),t)}),(r.param.config.fixed.first||r.param.config.fixed.last)&&(t=0,s.on("mouseenter",e[2],function(){t=$(this).index(),r.table.c.children("tr").eq(t).addClass("tr-hover"),r.table.l.children("tr").eq(t).addClass("tr-hover"),r.table.r.children("tr").eq(t).addClass("tr-hover")}).on("mouseleave",e[2],function(){r.table.c.children("tr").eq(t).removeClass("tr-hover"),r.table.l.children("tr").eq(t).removeClass("tr-hover"),r.table.r.children("tr").eq(t).removeClass("tr-hover")})),null!=r.searchBox&&s.on("click",e[3],function(){r.page=1,r.get[r.param.config.page.page_field]=r.page,_.unset(r.get,"_export");var t=r.searchBox.children("form").serialize();t!=r.query&&(r.get._search=1,r.query=t);t=_.split(t,"&");return _.each(t,function(t){t=_.split(t,"=");r.get[t[0]]=decodeURIComponent(t[1])}),r._loadData(!0),!1}).on("click",e[4],function(){return r.searchBox.find("input").val(""),Form.select(r.searchBox),!1}),null!=r.toolsBox&&_.each(r.param.button,function(n,t){var e=r.toolsBox.find("button").eq(t);if(null!=n.open){e.data("window-url",n.open.url);t=e.attr("id");return Eadmin.window("#"+t,n.open),!0}e.on("click",function(){if(!0!==n.check_checked||0!=r.checked){var t=function(){var t=[[],{}],e=t[0],a=t[1],t=t[2];if(0<(t=(t=r.haveFixed?r.table.l:r.table.c).find(".checkall:checked")).length&&(t.each(function(){e.push($(this).val())}),e=_.toString(e),a[r.param.config.checkbox]=e),null!=n.api)return Eadmin.get({url:n.api,param:a,popup:!0,then:function(){!0===n.refresh&&r._loadData()}}),!0;_.isFunction(n.callback)?n.callback(_.isArray(e)?"":e):console.log("按钮操作没有指明具体操作动作，无法执行")};if(!0===n.confirm)return Eadmin.popup.confirm({content:"确认执行此操作吗？",submit:t}),!0;t()}else Eadmin.popup.error({content:"请至少选择一项执行此操作"})})}),_.isBoolean(this.param.config.page)||s.on("change",e[5],function(){r.page=1,r.size=+$(this).val(),store(r.storeKey+"_page",r.page.toString()),store(r.storeKey+"_size",r.size.toString()),r.get[r.param.config.page.page_field]=r.page,r.get[r.param.config.page.size_field]=r.size,r._loadData(!0)}).on("click",e[6],function(){r.page=+$(this).html(),store(r.storeKey+"_page",r.page.toString()),r.get[r.param.config.page.page_field]=r.page,r._loadData(!0)}).on("click",e[7],function(){1!=r.page&&(--r.page,store(r.storeKey+"_page",r.page.toString()),r.get[r.param.config.page.page_field]=r.page,r._loadData(!0))}).on("click",e[8],function(){r.page!=r.pageCount&&(r.page+=1,store(r.storeKey+"_page",r.page.toString()),r.get[r.param.config.page.page_field]=r.page,r._loadData(!0))}).on("click",e[9],function(){var t=r.pageBox.find("input").val();""!=t?t<1?l("跳转的页数不能小于1"):t>r.pageCount?l("跳转的页数已经超出了最大页数"):t!=r.page?(store(r.storeKey+"_page",t),r.page=+t,r.get[r.param.config.page.page_field]=r.page,r._loadData(!0)):l("已经在待跳转的页面了"):l("跳转的页数不能为空")}),s.on("click",e[11],function(){var t=$(this);r.table.head.find(".active").removeClass("active"),t.addClass("active"),r.get.order=t.data("order"),r._loadData(!0)}).on("click",e[12],function(){var t=[$(this),{}],e=t[0],t=t[1];t.label=e.parent("label"),t.api=t.label.data("api"),t.field=t.label.data("field"),t.val=e.val(),t.param={},t.param[t.field]=t.val,Eadmin.get({url:t.api,param:t.param,popup:!0})}).on("click",e[13],function(){var t=[$(this),{}],e=t[0],a=t[1];a.row=e.data("row"),a.key=e.data("key"),a.btn=r.btns[a.row][a.key],null==a.btn.open?null!=a.btn.api&&(e=function(){Eadmin.get({url:a.btn.api,popup:!0,then:function(){!0===a.btn.refresh&&r._loadData()}})},!0!==a.btn.confirm?e():Eadmin.popup.confirm({content:"确定执行此操作吗？",submit:e})):Eadmin.window(!1,a.btn.open)}).on("click",e[14],function(){var t=[$(this),{}],e=t[0],t=t[1];t.row=e.data("row"),t.key=e.data("key"),t.open=r.columnOpen[t.row][t.key],Eadmin.window(!1,t.open)}),this.param.config.column_config&&Eadmin.dropdown("#"+this.columnId,{width:200,title:"表头设置",data:this.column}),this.param.config.export_excel&&(a=function(t,e){var a;window.navigator&&window.navigator.msSaveOrOpenBlob?window.navigator.msSaveOrOpenBlob(t,e):("object"==(void 0===t?"undefined":_typeof(t))&&t instanceof Blob&&(t=URL.createObjectURL(t)),(a=document.createElement("a")).href=t,a.download=e||"",e=void 0,window.MouseEvent?e=new MouseEvent("click"):(e=document.createEvent("MouseEvents")).initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),a.dispatchEvent(e))},n=function(t){var e={SheetNames:["sheet1"],Sheets:{}};e.Sheets.sheet1=t;e=XLSX.write(e,{bookType:"xlsx",bookSST:!0,type:"binary"});return new Blob([function(t){for(var e=new ArrayBuffer(t.length),a=new Uint8Array(e),n=0;n!=t.length;++n)a[n]=255&t.charCodeAt(n);return e}(e)],{type:"application/octet-stream"})},Method[this.exportExcel]=function(e){i.get._export=1,Eadmin.get({url:i.param.config.data,param:i.get,then:function(t){t=[i.excelColumn].concat(_toConsumableArray(t.list));t=XLSX.utils.json_to_sheet(t,{skipHeader:!0});a(n(t),createId()+".xlsx"),Eadmin.button.reset(e)}})})}},{key:"_checkbox",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;return!1===this.param.config.checkbox?"":null==t?'<td class="td-checkbox"><div>\n\t\t\t\t\t\t<label class="checkall-box">\n\t\t\t\t\t\t\t<input type="checkbox" class="checkall">\n\t\t\t\t\t\t</label>\n\t\t\t\t\t</div></td>':null==t[this.param.config.checkbox]?(console.log("复选框绑定的字段"+this.param.config.checkbox+"不存在"),""):'<td class="td-checkbox"><div>\n\t\t\t\t\t<label class="checkall-box">\n\t\t\t\t\t\t<input type="checkbox" class="checkall" value="'+t[this.param.config.checkbox]+'">\n\t\t\t\t\t</label>\n\t\t\t\t</div></td>'}},{key:"_page",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(!_.isBoolean(this.param.config.page))if(_.has(t,"count")){this.init||this.pageBox.data("size",this.size);var a={count:this.pageBox.find("em:first"),page:this.pageBox.find("em").eq(1),pageCount:this.pageBox.find("em").eq(2)};t.count==+a.count.html()&&this.size==this.pageBox.data("size")||(t.count<this.size?this.pageCount=1:t.count%this.size==0?this.pageCount=t.count/this.size:this.pageCount=parseInt(t.count/this.size)+1,a.count.html(t.count),a.pageCount.html(this.pageCount),this.size!=this.pageBox.data("size")&&this.pageBox.data("size",this.size)),a.page.html(this.page);t=10;_.has(this.param.config.page,"num")&&10<(t=(t=this.param.config.page.num)<3?3:t)&&(t=10);var n="",a=this.page,i=t+((a-=_.floor(t/2))<1?(a=1,0):this.page-_.floor(t/2)-1);(i=i>this.pageCount?this.pageCount:i)-a<t-1&&(a-=t-(i-a)-1);for(var l=a=a<1?1:a;l<=i;l++)n+='<span class="num-page'+(l==this.page?" current":"")+'" data-page="'+l+'">'+l+"</span>";this.pageBox.find(".num-page").remove(),this.pageBox.find(".prev-page").after(n),this.init&&e&&module.conf.page_show_message&&Eadmin.message.success({content:"当前第 "+this.page+" 页，共 "+this.pageCount+" 页"})}else console.log("数据源中未包含数据总条数count字段，创建分页失败")}},{key:"_loadData",value:function(){var f=this,a=0<arguments.length&&void 0!==arguments[0]&&arguments[0],v=this;this.checked=0,this.btns=[],this.columnOpen=[],this.shade.css("display","flex"),this.table.lbox.hide(),this.table.rbox.hide(),null!=this.searchBox&&this.searchBox.hide(),null!=this.toolsBox&&this.toolsBox.hide(),this.domCache.hide(),!1!==this.param.config.page&&this.pageBox.hide(),this.table.c.empty(),a&&(null!=this.window?_.startsWith(this.window,"#tab")||($(this.window+" .body")[0].scrollTop=0):box[0].scrollTop=0);function e(t){var e,o={data:t,html:"",fl:"",fr:""},c=function(t,e){return!0===t.tag?' data-tag="'+e[t.field]+'"':""},d=function(t,e){var a="";return _.isFunction(t.api)?a=t.api(e):console.log("没有指定保存开关状态的API地址"),'<label class="no-padding" data-api="'+a+'" data-field="'+t.field+'">\n\t\t\t\t\t\t\t\t<input type="radio" data-model="switch" value="'+e[t.field]+'">\n\t\t\t\t\t\t\t</label>'},h=function(t,e,i){e=t.button(e);v.btns.push(e);var l="";return _.each(e,function(t,e){var a=null!=t.icon?'<i class="'+t.icon+'"></i>':"",n=!0===t.disabled?" disabled":"";l+='<button \n\t\t\t\t\t\t\t\t\tid="'+("table-column-btn-"+i+"-"+e)+'" \n\t\t\t\t\t\t\t\t\t'+n+'\n\t\t\t\t\t\t\t\t\tdata-row="'+i+'" \n\t\t\t\t\t\t\t\t\tdata-key="'+e+'" \n\t\t\t\t\t\t\t\t\tclass="small column-btn" \n\t\t\t\t\t\t\t\t\tstyle="background:'+v.color[e]+"; border-color:"+v.color[e]+';"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t'+a+" "+t.name+"\n\t\t\t\t\t\t\t\t</button>"}),l},p=function(t,e){var a="";return a+='<img src="'+(_.isFunction(t.format)?t.format(e):e[t.field])+'"',!0===t.head&&(a+=' class="table-img-head"'),null!=t.style&&(a+=' style="'+t.style+'"'),a+=">"},u=function(t,e){var a=_.isFunction(t.format)?t.format(e):e[t.field],e=v.get[t.field];return a=!0===t.hl&&null!=e&&""!=e?_.replace(a,e,'<span style="color:red;">'+e+"</span>"):a},m=function(t,e){if(!_.isFunction(t.link))return"";if(_.isBoolean(e)&&e)return"</a>";t=t.link(e),e='<a href="'+t.href+'" data-native';return null!=t.target&&(e+=' target="'+t.target+'"'),e+=">"};null!=o.data.count||!1===f.param.config.page?null!=o.data.list?(f.domCache.show(),null!=f.searchBox&&f.searchBox.show(),null!=f.toolsBox&&f.toolsBox.show(),!1!==f.param.config.page&&f.pageBox.show(),0<o.data.list.length?(_.each(o.data.list,function(l,s){o.fl+="<tr>",o.fr+="<tr>",o.html+="<tr>",o.html+=f._checkbox(l),o.fl+=f._checkbox(l,!0);var r=0;_.each(f.param.column,function(t,e){if(!1===t.column)return!0;var a="";null!=t.open&&(a=" column-window",null==v.columnOpen[s]&&(v.columnOpen[s]=[]),v.columnOpen[s].push(t.open(l)));var n="<td";n+=c(t,l);var i=!0;n+=' class="td-'+e+a+((i=null!=f.columnConfig[t.field]?f.columnConfig[t.field]:i)?"":" dn")+'"',""!=a&&(n+=' data-row="'+s+'" data-key="'+r+'"',r++),n+=">",!0===t.switch?n+=d(t,l):_.isFunction(t.button)?n+=h(t,l,s):(n+=""!=a?'<a href="javascript:;">':m(t,l),n+=(!0===t.img?p:u)(t,l),n+=""!=a?"</a>":m(t,!0)),n+="</td>",0==e&&(o.fl+=n),o.html+=n,e+1==f.param.column.length&&(o.fr+=n)}),o.fl+="</tr>",o.html+="</tr>",o.fr+="</tr>"}),f.table.c.html(o.html),defaultImg(f.table.c),Tag.run(f.table.c),f.table.t.width()<=f.width?(f.table.lbox.remove(),f.table.rbox.remove(),f.haveFixed=!1):(!0===f.param.config.fixed.first&&(f.table.head.eq(0).find(".checkall-box").remove(),f.table.c.find(".checkall-box").remove(),f.table.l.html(o.fl),Eadmin.form(f.table.l)),!0===f.param.config.fixed.last&&(f.table.r.html(o.fr),Eadmin.form(f.table.r))),Eadmin.form(f.table.c),Progress.run(f.table.c),f._page(o.data,a),(e=f.table.head.find(":checkbox")).is(":checked")&&Form.checkbox(e,!1),f.table.lbox.show(),f.table.rbox.show(),0<(e=f.domCache.find(".empty")).length&&e.hide()):(!1!==f.param.config.page&&f.pageBox.hide(),0==(e=f.domCache.find(".empty")).length?f.domCache.append('<div class="empty">该列表暂无更多数据~</div>'):e.show()),f.shade.hide(),null!=f.param.callback&&f.param.callback(o.data),f.get._search=0,f.init||(f.scroll=Eadmin.scroll(f.dom+" .table-box","x"),f.table.t.width()<=f.width?f.table.t.width(f.width):f.domCache.children(".table-box").css("padding-bottom","18px"),f.init=!0)):console.log("数据源中没有包含list字段，创建表格失败"):console.log("返回的数据源中没有 count 字段，无法使用分页，请在配置中设置 page 为 false")}""!=this.param.config.data?Eadmin.get({url:this.param.config.data,param:this.get,then:function(t){e(t)}}):e({count:0,list:[]})}},{key:"_resize",value:function(){var t=this;$(window).on("resize",_.debounce(function(){t.width=+t.domCache.width(),t.table.box.width(t.width),t.table.t.width()<=t.width?(t.table.t.width(t.width),t.domCache.children(".table-box").css("padding-bottom",0)):t.domCache.children(".table-box").css("padding-bottom","18px"),null!=t.scroll&&t.scroll.update()},100))}}]),n}(),_createClass=function(){function n(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,a){return e&&n(t.prototype,e),a&&n(t,a),t}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Tag=function(){function t(){_classCallCheck(this,t)}return _createClass(t,null,[{key:"run",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=(t=null==t?body:$(t)).find("[data-tag]");0!=t.length&&t.each(function(){var t=[$(this),{html:""}],e=t[0],a=t[1];a.tag=_.words(e.data("tag")),_.each(a.tag,function(t,e){a.html+='<span class="tag color-'+(e+1)+'">'+t+"</span>"}),e.html(a.html)})}}]),t}(),_createClass=function(){function n(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,a){return e&&n(t.prototype,e),a&&n(t,a),t}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Tips=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"run",value:function(){var n=void 0,t=["[data-tips]:not(.tips-disabled)"];body.on("mouseenter",t[0],function(){clearTimeout(n),e.show($(this))}).on("mouseleave",t[0],function(){var t=[$(this),{tips:$(".tips")}],e=t[0],a=t[1];switch(a.pt=e.data("tips-position")||"top",a.pt){case"top":a.class="fadeOutUp";break;case"down":a.class="fadeOutDown";break;case"left":a.class="fadeOutLeft";break;case"right":a.class="fadeOutRight"}a.tips.addClass(a.class),n=setTimeout(function(){a.tips.remove()},200)})}},{key:"show",value:function(t){var e,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,n={tips:$(".tips")};switch(null==a&&(a={center:t.data("tips-center"),position:t.data("tips-position"),tips:t.data("tips"),offset:t.data("tips-offset")}),0==n.tips.length&&(n.style=null!=a.center?" text-align:center;":"",e=void 0,null!=Mount.window&&(e=$("#"+Mount.window).css("z-index"),n.style+=e=null==e?"":"z-index:"+e+";"),n.html='<div style="'+n.style+'" class="tips animated faster">\n\t\t\t\t\t\t<div></div>\n\t\t\t\t\t\t<div class="tips-arrow"></div>\n\t\t\t\t\t</div>',$("body").append(n.html),n.tips=$(".tips")),n.offset=t.offset(),n.left=n.offset.left,n.top=n.offset.top,n.pt=a.position||"top",n.txt=a.tips,null==n.txt&&(n.txt="默认文案"),n.tips.children("div:first").html(n.txt),"right"==n.pt&&distance(t,"right")<n.tips.outerWidth()+30?(n.pt="left",t.data("tips-position","left")):"left"==n.pt&&distance(t,"left")<n.tips.outerWidth()+30&&(n.pt="right",t.data("tips-position","right")),n.pt){case"top":n.class="fadeInDown",n.arrow="down";break;case"down":n.class="fadeInUp",n.arrow="top";break;case"left":n.class="fadeInLeft",n.arrow="right";break;case"right":n.class="fadeInRight",n.arrow="left"}switch(n.tips.attr("class","tips animated faster "+n.class).children("div:last").attr("class","tips-arrow "+n.arrow),"top"==n.pt||"down"==n.pt?n.offset=n.tips.outerWidth()/2-t.outerWidth()/2:n.offset=n.tips.outerHeight()/2-t.outerHeight()/2,n.pt){case"top":n.top=n.top-n.tips.outerHeight()-10,n.left-=n.offset;break;case"down":n.top=n.top+t.outerHeight()+10,n.left-=n.offset;break;case"left":n.left=n.left-n.tips.outerWidth()-10,n.top-=n.offset;break;case"right":n.left=n.left+t.outerWidth()+10,n.top-=n.offset}n.tips.css({left:n.left,top:n.top})}},{key:"reset",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},a={tips:$(".tips")};a.txt=t.data("tips"),a.tips.children("div:first").html(a.txt),a.left=_.floor(t.offset().left),a.offset=e.offset,"middle"==a.offset&&(a.offset=a.tips.outerWidth()/2-t.outerWidth()/2),a.left-=a.offset,a.tips.css({left:a.left})}},{key:"destory",value:function(t){t.trigger("mouseleave")}}]),e}(),_createClass=function(){function n(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,a){return e&&n(t.prototype,e),a&&n(t,a),t}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Transfer=function(){function a(t,e){_classCallCheck(this,a),this.dom=t,this.domCache=scope(this.dom),0!=this.domCache.length?null!=e&&null!=e.data?(_.isString(e.data)&&(_.startsWith(e.data,"http")||(e.data=module.conf.http.baseURL+e.data),$.ajax({url:e.data,type:"get",async:!1,dataType:"json",success:function(t){null!=t[module.conf.http.code_field]?null!=t[module.conf.http.data_field]?e.data=t[module.conf.http.data_field]:console.log("接口返回结果中没有找到定义的数据体字段"):console.log("接口返回结果中没有找到定义的code码字段")}})),0!=e.data.length?(this.param=$.extend({data:{},search:!1,width:0,height:0,bind:"transfer"},e),this.domCache.addClass("transfer-box"),this.run()):console.log("穿梭框"+this.dom+"数据源为空，创建失败")):console.log("穿梭框"+this.dom+"没有指定数据源：data，创建失败"):console.log("没有找到"+this.dom+"穿梭框容器，创建失败")}return _createClass(a,[{key:"run",value:function(){this._create(),this._event()}},{key:"_create",value:function(){var t,e,a,n={from:[],to:[],height:226,style:' style="',search:"",html:""};for(t in this.param.data){var i=this.param.data[t];(null!=i.checked&&i.checked?n.to:n.from).push(i)}for(e in 0<this.param.width&&(n.style+="width:"+this.param.width+"px;"),0<this.param.height&&(n.style+="height:"+this.param.height+"px;",n.height=this.param.height-40),n.style+='"',this.param.search&&(n.search=" transfer-body-search",n.height-=32),n.html='<div class="transfer-box-list"'+n.style+'>\n\t\t\t\t\t<div class="transfer-header">\n\t\t\t\t\t\t<label>\n\t\t\t\t\t\t\t<input type="checkbox" data-num="0"> 源列表\n\t\t\t\t\t\t</label>\n\t\t\t\t\t\t<span class="count">\n\t\t\t\t\t\t\t<em>0</em> / <em>'+n.from.length+'</em>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="iscroll transfer-body'+n.search+'" style="height:'+n.height+'px;"><ul>',n.from){var l=1==n.from[e].disabled?' class="disabled"':"";n.html+="<li"+l+'>\n\t\t\t\t\t\t\t<label>\n\t\t\t\t\t\t\t\t<input data-num="0" value="'+n.from[e].val+'" type="checkbox" '+l+"> "+n.from[e].txt+"\n\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t</li>"}for(a in n.html+="</ul></div>",this.param.search&&(n.html+='<div class="transfer-search">\n\t\t\t\t\t\t\t<label>\n\t\t\t\t\t\t\t\t<input data-num="0" class="search-input" type="text" placeholder="请输入搜索内容" data-icon="ri-search-line|right">\n\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t</div>'),n.html+='</div><div class="transfer-button">\n\t\t\t\t\t\t<button disabled class="hl" data-num="0">\n\t\t\t\t\t\t\t<i class="ri-arrow-left-s-line"></i>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t\t<button disabled class="hl" data-num="1">\n\t\t\t\t\t\t\t<i class="ri-arrow-right-s-line"></i>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>',n.html+='<div class="transfer-box-list"'+n.style+'>\n\t\t\t\t\t<div class="transfer-header">\n\t\t\t\t\t\t<label>\n\t\t\t\t\t\t\t<input type="checkbox" data-num="1"> 目标列表\n\t\t\t\t\t\t</label>\n\t\t\t\t\t\t<span class="count"><em>0</em> / <em>'+n.to.length+'</em></span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="iscroll transfer-body'+n.search+'" style="height:'+n.height+'px;"><ul>',n.default=[],n.to){var s=1==n.to[a].disabled?"disabled":"";n.html+='<li class="'+s+'">\n\t\t\t\t\t\t\t<label>\n\t\t\t\t\t\t\t\t<input data-num="1" value="'+n.to[a].val+'" type="checkbox" '+s+"> "+n.to[a].txt+"\n\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t</li>",n.default.push(n.to[a].val)}n.html+="</ul></div>",this.param.search&&(n.html+='<div class="transfer-search">\n\t\t\t\t\t\t\t<label>\n\t\t\t\t\t\t\t\t<input data-num="1" class="search-input" type="text" placeholder="请输入搜索内容" data-icon="ri-search-line|right">\n\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t</div>'),n.html+='</div><input type="hidden" name="'+this.param.bind+'" value="'+_.join(n.default,",")+'">',this.domCache.html(n.html)}},{key:"_event",value:function(){var t=[".transfer-header :checkbox",".transfer-body :checkbox",".transfer-button button"],a=this,e=[this.domCache.find(".transfer-body"),this.domCache.find(".transfer-header"),this.domCache.find(".transfer-button")],n=e[0],i=e[1],l=e[2];this.domCache.on("click",t[0],function(){var t=$(this),e={eq:+t.data("num")};e.neq=1==e.eq?0:1,e.checkbox=n.eq(e.eq).find(":checkbox").not(":disabled"),t.is(":checked")?(Form.checkbox(e.checkbox,1),i.eq(e.eq).find("em:first").html(e.checkbox.length),l.children("button").eq(e.neq).prop("disabled",!1)):(Form.checkbox(e.checkbox,0),i.eq(e.eq).find("em:first").html(0),l.children("button").eq(e.neq).prop("disabled",!0))}).on("click",t[1],function(){var t={eq:+$(this).data("num")};t.neq=1==t.eq?0:1,t.all=n.eq(t.eq).find(":checkbox").length,t.checked=n.eq(t.eq).find(":checked").length,t.checkall=i.eq(t.eq).find(":checkbox"),i.eq(t.eq).find("em:first").html(t.checked),Form.checkbox(t.checkall,t.checked==t.all?1:0),t.disabled=!(0<t.checked),l.children("button").eq(t.neq).prop("disabled",t.disabled)}).on("click",t[2],function(){var t=$(this),e={eq:+t.data("num")};e.neq=1==e.eq?0:1,t.prop("disabled",!0),e.checked=n.eq(e.neq).find(":checkbox:checked").parent().parent(),e.clone=e.checked.clone(),e.checkbox=e.clone.find(":checkbox"),e.checkbox.data("num",e.eq),Form.checkbox(e.checkbox,0),n.eq(e.eq).children("ul").prepend(e.clone),e.checked.remove(),i.eq(e.neq).find("em:first").html(0),i.eq(e.neq).find("em:last").html(n.eq(e.neq).find(":checkbox").length),i.eq(e.eq).find("em:last").html(n.eq(e.eq).find(":checkbox").length),e.checkbox=i.eq(e.neq).find(":checkbox"),Form.checkbox(e.checkbox,0),e.val=[],n.eq(1).find(":checkbox").each(function(){e.val.push($(this).val())}),a.domCache.children("input[type='hidden']").val(_.join(e.val,",")),a.param.search&&(a.domCache.find(".search-input").eq(e.neq).val(""),n.eq(e.neq).find("li").show())}),a.param.search&&keyup(a.domCache.find(".search-input"),function(t){var e={eq:+t.data("num"),val:t.val(),body:a.domCache.find(".transfer-body")};""!=e.val?e.body.eq(e.eq).find("li").each(function(){var t=$(this);-1!=t.text().indexOf(e.val)?t.show():t.hide()}):e.body.eq(e.eq).find("li").show()})}}]),a}(),_createClass=function(){function n(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,a){return e&&n(t.prototype,e),a&&n(t,a),t}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Tree=function(){function n(t,e){_classCallCheck(this,n),this.dom=scope(t),this.dom.addClass("tree"),this.data=_.cloneDeep(e.data);var a;0!=e.data.length?(function e(a,n,i){return i.filter(function(t){return t.pid===a}).forEach(function(t){t.children=e(t.id,[],i),n.push(t)}),n}(0,t=[],this.data),function n(t){_.each(t,function(t){var e=t.children.length;if(0==e)return!0;var a=_.filter(t.children,["checked",!0]).length;0<a&&a<e&&(t.half=!0),n(t.children)})}(t),this.param=$.extend({data:[],checkbox:!1,open:!1,oncheck:null,onclick:null,bind:""},e),this.input=null,this.param.data=t,this.data=e.data,""!=this.param.bind&&this.param.checkbox&&(a=[],_.each(this.data,function(t){t.checked&&a.push(t.id)}),this.dom.after('<input type="hidden" name="'+this.param.bind+'" value="'+_.join(a,",")+'">'),this.input=this.dom.next("input")),this.run()):this.dom.html('<span class="note mt20">没有树形菜单数据</span>')}return _createClass(n,[{key:"run",value:function(){this._create(),this._event()}},{key:"_create",value:function(){var r=this,o={html:""};(function i(l,t){var e=2<arguments.length&&void 0!==arguments[2]&&arguments[2],s=3<arguments.length&&void 0!==arguments[3]&&arguments[3];0<l&&(o.html+="<div",!0===e||r.param.open||(o.html+=' class="dn"'),o.html+=">"),_.each(t,function(t){var e=["",0,t.children.length],a=e[0],n=e[1],e=e[2];0==l?(0==e&&(a=' style="padding-left:20px;"'),!r.param.open&&!0!==t.open||(n=1)):(!0!==t.open&&!r.param.open||(n=1),r.param.checkbox&&(a+=' class="tree-checkbox"'),0==e&&(a+=' style="padding-left:'+(r.param.checkbox?46:38)+'px;"')),o.html+="<ul"+a+"><li>",0<e&&(o.html+='<i data-open="'+n+'" class="ri-arrow-right-s-line '+(1==n?"rotate-90":"rotate-0")+'"></i>'),r.param.checkbox?(!(n="")!==t.checked&&!0!==t.half||(n+=" checked"),!0!==t.disabled&&!0!==s||(n+=" disabled"),!0===t.half&&(n+=' class="checkbox-half"'),o.html+='<label>\n\t\t\t\t\t\t\t\t\t<input \n\t\t\t\t\t\t\t\t\t\tid="'+t.id+'" \n\t\t\t\t\t\t\t\t\t\tdata-pid="'+t.pid+'"\n\t\t\t\t\t\t\t\t\t\ttype="checkbox" \n\t\t\t\t\t\t\t\t\t\t'+n+"> "+t.name+"\n\t\t\t\t\t\t\t\t</label>"):o.html+='<span \n\t\t\t\t\t\t\t\t\tdata-tree-node="'+t.id+'" \n\t\t\t\t\t\t\t\t\t'+(r.param.checkbox?"":' class="cp"')+">"+t.name+"\n\t\t\t\t\t\t\t\t</span>",0<e&&(!0===s&&(t.disabled=s),i(l+1,t.children,t.open,t.disabled)),o.html+="</li></ul>"}),0<l&&(o.html+="</div>")})(0,this.param.data),this.dom.html(o.html)}},{key:"_event",value:function(){var t=["[data-open]",":checkbox","[data-tree-node]"],l=this;l.dom.on("click",t[0],function(){var t=[$(this),{}],e=t[0],t=t[1];if(t.open=e.data("open"),t.child=e.next().next(),0==t.open)return e.data("open",1).removeClass("rotate-0").addClass("rotate-90"),void t.child.slideDown(200);e.data("open",0).removeClass("rotate-90").addClass("rotate-0"),t.child.slideUp(200)}).on("click",t[1],function(){var t=[$(this),{}],e=t[0],a=t[1],n={checkChild:function(t){t=l.dom.find('input[data-pid="'+t+'"]:not(:disabled)');0!=t.length&&(Form.checkbox(t,a.check),t.each(function(){n.checkChild($(this).attr("id"))}))},checkParent:function(t){var e,a=l.dom.find("#"+t);0!=a.length&&(l.dom.find('input[data-pid="'+t+'"]').length==(e=l.dom.find('input[data-pid="'+t+'"]:not(.checkbox-half):checked').length)?Form.checkbox(a,!0):0!=e||0<l.dom.find('.checkbox-half[data-pid="'+t+'"]:checked').length?Form.checkbox(a,!0,!0):Form.checkbox(a,!1),a.each(function(){n.checkParent($(this).data("pid"))}))}};a.check=e.is(":checked"),a.pid=e.data("pid"),a.id=e.attr("id"),n.checkChild(a.id),n.checkParent(a.pid),a.checked=l.dom.find(":checked");var i=[];a.checked.each(function(){i.push(parseInt($(this).attr("id")))}),null!=l.input&&l.input.val(_.join(i,","));e=l.data.filter(function(t){return-1!=i.indexOf(t.id)});null!=l.param.oncheck&&l.param.oncheck(e)}),l.param.checkbox||null==l.param.onclick||l.dom.on("click",t[2],function(){var e=$(this).data("tree-node"),t=l.data.filter(function(t){return t.id===e});l.param.onclick(t[0])})}}]),n}(),_createClass=function(){function n(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,a){return e&&n(t.prototype,e),a&&n(t,a),t}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Upload=function(){function a(t,e){_classCallCheck(this,a),this.dom=t,this.domCache=scope(this.dom),this.dom+=(new Date).valueOf(),this.domCache.attr("id",this.dom.replace("#","")),this.upload=null,this.pic=[];this.param=$.extend({filename:"file",doc:[".jpg",".gif",".png",".jpeg"],autoupload:!0,maxsize:5e3,maxfile:null,default:"",bind:"",mini:!1},e),this.param.mini&&(this.param.maxfile=1,this.param.autoupload=!0),null!=this.param.api?(this.param.maxsize/=1e3,!_.startsWith(this.param.api,"http")&&_.startsWith(module.conf.http.baseURL,"http")&&(this.param.api=module.conf.http.baseURL+this.param.api),this.run()):console.log("请指定后端接收上传数据的API地址")}return _createClass(a,[{key:"run",value:function(){this._create(),this._init(),this._event()}},{key:"_create",value:function(){var t="",e="";this.param.mini?(t='<div class="dz-message dz-mini">\n\t\t\t\t\t\t<i class="ri-image-add-line"></i>\n\t\t\t\t\t</div>',e=" dropzone-mini"):t='<div class="dz-message">\n\t\t\t\t\t\t<i class="ri-upload-cloud-2-line"></i>\n\t\t\t\t\t\t将文件拖至此处或点击上传\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="dz-button">\n\t\t\t\t\t\t<span>待上传：<em></em></span>\n\t\t\t\t\t\t<button class="hl small dz-upload-btn">开始上传</button>\n\t\t\t\t\t</div>',this.domCache.addClass("dropzone"+e).html(t),""!=this.param.bind&&this.domCache.after('<input type="hidden" name="'+this.param.bind+'" value="'+this.param.default+'">')}},{key:"_init",value:function(){var a=this,t={button:this.domCache.children(".dz-button")};t.uploadTmp='<div class="dz-preview dz-image-preview'+(this.param.mini?" dz-preview-mini":"")+'">\n\t\t\t\t\t\t\t<div class="dz-image">\n\t\t\t\t\t\t\t\t<img data-dz-thumbnail />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="dz-details">\n\t\t\t\t\t\t\t\t<div class="dz-filename"><span data-dz-name></span></div>\n\t\t\t\t\t\t\t\t<div class="dz-size" data-dz-size></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="dz-progress">\n\t\t\t\t\t\t\t\t<span class="dz-upload" data-dz-uploadprogress></span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<i class="ri-checkbox-circle-fill dz-success-i"></i>\n\t\t\t\t\t\t\t<i class="ri-close-circle-fill dz-error-i"></i>\n\t\t\t\t\t\t\t<i class="ri-close-line dz-remove-i" data-dz-remove></i>\n\t\t\t\t\t\t</div>',this.upload=new Dropzone(this.dom,{url:this.param.api,paramName:this.param.filename,maxFilesize:this.param.maxsize,acceptedFiles:_.join(this.param.doc,","),autoProcessQueue:this.param.autoupload,timeout:1e5,parallelUploads:1e3,previewTemplate:t.uploadTmp,maxFiles:this.param.maxfile,dictFileTooBig:"允许上传文件的最大限制为：{{maxFilesize}}MB",dictInvalidFileType:"上传的文件格式不被允许",dictResponseError:"上传文件失败，返回码：{{statusCode}}",dictMaxFilesExceeded:"上传的文件数量超出限制"}),""!=this.param.default&&(t.default=this.param.default.split(","),this.pic=t.default,_.each(t.default,function(t){var e={name:t,accepted:!0};a.upload.emit("addedfile",e),a.upload.emit("thumbnail",e,t),a.upload.emit("success",e),a.upload.emit("complete",e),a.upload.files.push(e)})),Mount.dropzone.push(this.upload)}},{key:"_event",value:function(){var a=this,n={button:a.domCache.find(".dz-button")};a.upload.on("addedfile",function(t){-1==t.type.indexOf("image")&&a.domCache.find(".dz-details").show(),a.param.autoupload||(n.button.is(":hidden")&&(a.domCache.css("padding-bottom",40),n.button.show()),t=a.domCache.find(".dz-preview:not(.dz-complete)").length,n.button.find("em").html(t))}).on("removedfile",function(t){var e;"error"!=t.status&&(e=a.domCache.find(".dz-preview:not(.dz-complete)").length,n.button.find("em").html(e),0==(e=a.domCache.find(".dz-preview").length)&&(a.domCache.css("padding-bottom",10),n.button.hide()),e=void 0,e=[e=null!=t.xhr?JSON.parse(t.xhr.response).file:t.name],a.pic=_.xor(a.pic,e),""!=a.param.bind&&a.domCache.next("input").val(_.split(a.pic,",")))}).on("success",function(t,e){return null!=e[module.conf.http.code_field]&&e[module.conf.http.code_field]!=module.conf.http.code_success?(a.upload.removeFile(t),void Eadmin.message.error({content:e[module.conf.http.msg_field]})):void(null!=e.file?(t=parseInt(n.button.find("em").html()),n.button.find("em").html(t-1),a.pic.push(e.file)):console.log("后端上传接口的返回值中没有file字段，上传操作失败"))}).on("error",function(t,e){a.upload.removeFile(t),Eadmin.message.error({content:e})}).on("queuecomplete",function(){""!=a.param.bind&&a.domCache.next("input").val(_.split(a.pic,","))}),a.param.autoupload||$(a.dom+" .dz-upload-btn").on("click",function(){return a.upload.processQueue(),!1})}}]),a}(),_createClass=function(){function n(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,a){return e&&n(t.prototype,e),a&&n(t,a),t}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Validate=function(){function t(){_classCallCheck(this,t)}return _createClass(t,null,[{key:"run",value:function(){var a=this;body.on("blur",":text[data-validate], :password[data-validate], textarea[data-validate]",function(){a._check($(this))}).on("click",":checkbox, :radio",function(){var t=[$(this),{}],e=t[0],t=t[1];t.parent=e.closest(".form-group"),t.dom=t.parent.find('[name="'+e.attr("name")+'"]:first'),null!=t.dom.data("validate")&&a._check(t.dom)}).on("change","select[data-validate]",function(){a._check($(this))})}},{key:"submit",value:function(t){t=t.find("[data-validate]");if(!t.length)return!0;var e=this;t.each(function(){var t=$(this);return!!t.is(":hidden")||(null!=t.data("validate-error")||void e._check(t))})}},{key:"_check",value:function(t){var e=this,a={this:t},n={preg:function(t){var e;return(e=[]).require="[.\\s\\S]+",e.mobile="1[345789][\\d]{9}",e.phone="([\\d]{3,4}-)?[\\d]{7,8}",e.email="[\\w-\\.]+@[\\w-\\.]+(\\.\\w+)+",e.qq="[1-9][\\d]{5,10}",e.idcard="(^\\d{15}$)|(^\\d{17}(\\d|X|x)$)",e.url='(http://|https://)?[A-Za-z0-9]+\\.[A-Za-z0-9]+([/=?%-&_#@[]+!])*([^<>"])*',e.date="\\d{4}[/-]+\\d{2}[/-]+\\d{2}",e.money="\\d{1,}\\.\\d{2,4}$",e.ip="\\d{1,}\\.\\d{1,}\\.\\d{1,}\\.\\d{1,}",e.number="^[\\d]+$",e.letter="^[\\w]+$",e.numberLetter="^[0-9a-zA-Z]+$",e.zipcode="[1-9][0-9]{5}",null!=e[t]&&e[t]},check:function(t,e){var a=n.preg(t);return!1===a&&(a=t),!!new RegExp(a).test(e)},set:function(){var t=0<arguments.length&&void 0!==arguments[0]&&arguments[0];a.this.is("textarea")?Form.textarea(a.this,t):Form.input(a.this,t)},success:function(){null!=a.this.data("validate-error")&&(a.note=e._note(a.this),0==a.this.data("note")?a.note.remove():a.note.removeClass("error").html(a.this.data("note")),a.this.removeData("validate-error"))},error:function(t){a.note=e._note(a.this),a.this.data("validate-error",1),null!=a.msg&&a.note.addClass("error").html(t)}};return a.rule=a.this.data("validate"),a.msg=a.this.data("validate-msg"),a.this.is("select")?0==a.this.find(":selected").index()?void n.error(a.msg):void n.success():a.this.is(":checkbox")||a.this.is(":radio")?(a.parent=a.this.closest(".form-group"),0==a.parent.find('[name="'+a.this.attr("name")+'"]:checked').length?void n.error(a.msg):void n.success()):(a.val=a.this.val(),a.arr={},a.arr.rule=a.rule.split("|"),null!=a.msg&&(a.arr.msg=a.msg.split("|")),a.result=!0,a.key=0,_.each(a.arr.rule,function(t,e){if(-1!=t.indexOf("len")){if(t=t.replace("len=",""),a.arr.len=t.split("-"),""!=a.arr.len[0]&&a.val.length<a.arr.len[0]||""!=a.arr.len[1]&&a.val.length>a.arr.len[1])return a.result=!1,a.key=e,!1}else if(-1!=t.indexOf("val")){if(t=t.replace("val=",""),a.val=parseInt(a.val),a.arr.val=t.split("-"),_.isNaN(a.val)||""!=a.arr.val[0]&&a.val<a.arr.val[0]||""!=a.arr.val[1]&&a.val>a.arr.val[1])return a.result=!1,a.key=e,!1}else if(!n.check(t,a.val))return a.result=!1,a.key=e,!1}),a.result?(n.set(!0),void n.success()):(n.set(),void n.error(a.arr.msg[a.key])))}},{key:"_note",value:function(t){var e=t.closest(".form-group"),a=e.find(".note");return a.length?null==t.data("note")&&t.data("note",a.html()):(e.append('<span class="note"></span>'),a=e.find(".note"),null==t.data("note")&&t.data("note",!1)),a}}]),t}(),_createClass=function(){function n(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,a){return e&&n(t.prototype,e),a&&n(t,a),t}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Window=function(){function a(t,e){_classCallCheck(this,a),this.window="",this.windowDom=null,this.dom=0!=t&&scope(t),this.x=0,this.y=0,this.top=0,this.left=0;t={url:"",model:"load",width:module.conf.window_width,height:module.conf.window_height,title:module.conf.window_title,drag:!0,btn:[],close:null,style:"window"};this.param=$.extend(!0,t,e),this.run()}return _createClass(a,[{key:"run",value:function(){this._event()}},{key:"_create",value:function(){var a={id:createId(),width:0,height:0,style:"",drag:"",html:""};this.window="window-"+a.id,_.isInteger(this.param.width)||-1==this.param.width.indexOf("%")?a.width=this.param.width:a.width=innerW()*(parseInt(this.param.width.replace("%",""))/100),"popup"==this.param.style?a.height=innerH():_.isInteger(this.param.height)||-1==this.param.height.indexOf("%")?a.height=this.param.height:a.height=innerH()*(parseInt(this.param.height.replace("%",""))/100),a.style='style="width:'+a.width+"px;height:"+a.height+"px;","popup"==this.param.style?a.style+='top:0;right:0;left:unset;border-radius:5px 0 0 5px;"':a.style+="margin-left:-"+a.width/2+"px;margin-top:-"+a.height/2+'px;"',this.param.drag&&"window"==this.param.style&&(a.drag=' style="cursor: move;"'),a.height-=60,0<this.param.btn.length&&(a.height-=50),a.html='<div id="'+this.window+'" \n\t\t\t\t\t\tclass="window animated faster'+(null==Mount.window?"":" "+Mount.window)+' dn" '+a.style+'>\n\t\t\t\t\t<div class="window-loading dn">\n\t\t\t\t\t\t<i class="ri-loader-4-line rotate"></i>页面加载中，请稍候...\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="window-close">\n\t\t\t\t\t\t<i class="ri-close-circle-fill"></i>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="title"'+a.drag+'>\n\t\t\t\t\t\t<i class="ri-window-line" style="font-size: 18px;"></i><span>'+this.param.title+'</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="body" style="height:'+a.height+'px;"></div>',0<this.param.btn.length&&(a.html+='<div class="btnbar">',_.each(this.param.btn,function(t){null==t.hl&&(t.hl=!0),null==t.action&&(t.action="submit");var e=-1==["cancel","refresh"].indexOf(t.action)?' data-loading="执行中..."':"";a.html+="<button\n\t\t\t\t\t\t\t\t"+(t.hl?' class="hl"':"")+"\n\t\t\t\t\t\t\t\t"+e+("submit"==t.action?" data-submit":"")+">\n\t\t\t\t\t\t\t"+t.name+"\n\t\t\t\t\t\t\t</button>"}),a.html+="</div>"),a.html+="</div>",body.append(a.html),this.windowDom=$("#"+this.window)}},{key:"_event",value:function(){var l=this,s={},r={close:function(){var t=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],e=null!=(e=l.windowDom.data("change"));$("."+l.window).remove();var a=l.windowDom.find(".tab-panel");0<a.length&&a.each(function(){var t=$(this).attr("id");if(null==t)return!0;$("."+t).remove()}),l.windowDom.remove(),Mount.window=null,Eadmin.maskHide(),t&&_.isFunction(l.param.close)&&l.param.close(e)},load:function(){var t;"iframe"!=l.param.model?(s.loading.show(),t=100,"popup"==l.param.style&&(t=200),setTimeout(function(){null!=s.scroll&&(s.scroll.destroy(),s.scroll=null),Mount.window=l.window;var t=query(l.param.url);s.body.before('<input type="hidden" id="'+Mount.window+"_query\" value='"+t+"'>").load(l.param.url,function(){defaultImg(s.body),s.loading.hide(),block(s.body),Eadmin.form(s.body),Button.run(l.windowDom),Tag.run(s.body),s.scroll=Eadmin.scroll("#"+l.window+" .body");var t=body.find(".iscroll");0<t.length&&t.each(function(){return!!$(this).hasClass("ps")||void Eadmin.scroll($(this)[0])}),Progress.run(s.body)})},t)):(t='<iframe \n\t\t\t\t\t\t\t\t\tsrc="'+l.param.url+'" \n\t\t\t\t\t\t\t\t\twidth="100%" \n\t\t\t\t\t\t\t\t\theight="100%" \n\t\t\t\t\t\t\t\t\tframeborder="0" scrolling="auto">\n\t\t\t\t\t\t\t\t</iframe>',s.body.html(t))},init:function(t){l._create(),s={this:t,title:l.windowDom.children(".title"),body:l.windowDom.children(".body"),loading:l.windowDom.children(".window-loading"),scroll:null},0!=t&&(l.param.url=s.this.data("window-url")),Eadmin.currentHref=l.param.url,null!=l.param.url&&""!=l.param.url?(0!=(t=Eadmin.mask())&&l.windowDom.css("z-index",t),l.windowDom.off("animationend").show().addClass("window"==l.param.style?"zoomIn":"fadeInRight"),r.load(),l.windowDom.children(".window-close").on("click",function(){r.close()}),l.param.drag&&s.title.on("mousedown",function(t){selectEnabled&&userselect(0);var e=l.windowDom.offset();l.x=t.clientX,l.y=t.clientY,l.top=e.top,l.left=e.left;var a=l.windowDom.css("margin-left"),n=l.windowDom.css("margin-top"),a=parseInt(a),n=parseInt(n);$(document).on("mousemove",function(t){var e=l.top+(t.clientY-l.y),t=l.left+(t.clientX-l.x);l.windowDom.css({top:e-=n,left:t-=a})})}).on("mouseup",function(){selectEnabled&&userselect(1),$(document).off("mousemove")}),0!=l.param.btn.length&&l.windowDom.children(".btnbar").children("button").on("click",function(){var t=[$(this),{}],e=t[0],a=t[1];if(a.index=e.index(),a.param=l.param.btn[a.index],_.isString(a.param.action))if(a.action=["cancel","refresh","submit"],-1!=a.action.indexOf(a.param.action))switch(a.param.action){case"cancel":r.close();break;case"refresh":s.body.empty(),r.load();break;case"submit":var n=function(){s.form=s.body.find(a.param.formid||"form"),0!=s.form.length?(s.action=s.form.attr("action")||l.param.url,Validate.submit(s.form),0<s.form.find("span.error").length||(Eadmin.button.loading(e),s.formData=s.form.serialize(),Eadmin.post({url:s.action,form:s.formData,then:function(t){var e=s.form.find(".editor");0<e.length&&e.each(function(){var t=$(this).data("store");null!=t&&store.remove(t)}),_.isFunction(l.param.close)&&l.param.close(!0,t)},error:function(){Eadmin.button.reset(e)},close:function(){r.close(!1)}}))):console.log("窗体内没有找到form表单元素，提交表单失败")};if(null!=a.param.before)return null==Method||null==Method[a.param.before]?(console.log("弹窗页面中没有找到指定的前置方法"+a.param.before),!1):void Method[a.param.before](n);n()}else console.log("没有找到内置按钮事件："+a.param.action);else{var i=function(){setTimeout(function(){Eadmin.button.reset(e)},100)};a.param.action({window:l.windowDom,close:function(){r.close()},refresh:function(){i(),s.body.empty(),r.load()},reset:function(){i()}})}})):console.log("没有指定弹窗地址，打开失败")}};0!=l.dom?l.dom.on("click",function(){r.init($(this))}):r.init(!1)}}]),a}();